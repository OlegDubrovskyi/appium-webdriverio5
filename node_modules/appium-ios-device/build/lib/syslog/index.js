"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SYSLOG_SERVICE_NAME = exports.SyslogService = void 0;

require("source-map-support/register");

var _syslogDecoder = _interopRequireDefault(require("./transformer/syslog-decoder"));

var _constants = require("../constants");

const SYSLOG_SERVICE_NAME = 'com.apple.syslog_relay';
exports.SYSLOG_SERVICE_NAME = SYSLOG_SERVICE_NAME;
const START_MESSAGE = 'start';

class SyslogService {
  constructor(socketClient) {
    this._socketClient = socketClient;
    this._decoder = new _syslogDecoder.default(5 * _constants.KB);

    this._socketClient.pipe(this._decoder);
  }

  start(callback) {
    this._decoder.on('data', callback);

    this._socketClient.write(START_MESSAGE);
  }

  close() {
    this._socketClient.destroy();
  }

}

exports.SyslogService = SyslogService;
var _default = SyslogService;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zeXNsb2cvaW5kZXguanMiXSwibmFtZXMiOlsiU1lTTE9HX1NFUlZJQ0VfTkFNRSIsIlNUQVJUX01FU1NBR0UiLCJTeXNsb2dTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJzb2NrZXRDbGllbnQiLCJfc29ja2V0Q2xpZW50IiwiX2RlY29kZXIiLCJTeXNsb2dEZWNvZGVyIiwiS0IiLCJwaXBlIiwic3RhcnQiLCJjYWxsYmFjayIsIm9uIiwid3JpdGUiLCJjbG9zZSIsImRlc3Ryb3kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ0E7O0FBQ0E7O0FBR0EsTUFBTUEsbUJBQW1CLEdBQUcsd0JBQTVCOztBQUNBLE1BQU1DLGFBQWEsR0FBRyxPQUF0Qjs7QUFFQSxNQUFNQyxhQUFOLENBQW9CO0FBRWxCQyxFQUFBQSxXQUFXLENBQUVDLFlBQUYsRUFBZ0I7QUFDekIsU0FBS0MsYUFBTCxHQUFxQkQsWUFBckI7QUFDQSxTQUFLRSxRQUFMLEdBQWdCLElBQUlDLHNCQUFKLENBQWtCLElBQUlDLGFBQXRCLENBQWhCOztBQUNBLFNBQUtILGFBQUwsQ0FBbUJJLElBQW5CLENBQXdCLEtBQUtILFFBQTdCO0FBRUQ7O0FBQ0RJLEVBQUFBLEtBQUssQ0FBRUMsUUFBRixFQUFZO0FBQ2YsU0FBS0wsUUFBTCxDQUFjTSxFQUFkLENBQWlCLE1BQWpCLEVBQXlCRCxRQUF6Qjs7QUFDQSxTQUFLTixhQUFMLENBQW1CUSxLQUFuQixDQUF5QlosYUFBekI7QUFDRDs7QUFFRGEsRUFBQUEsS0FBSyxHQUFJO0FBQ1AsU0FBS1QsYUFBTCxDQUFtQlUsT0FBbkI7QUFDRDs7QUFmaUI7OztlQW9CTGIsYSIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHByb21pc2UvcHJlZmVyLWF3YWl0LXRvLWNhbGxiYWNrcyAqL1xuaW1wb3J0IFN5c2xvZ0RlY29kZXIgZnJvbSAnLi90cmFuc2Zvcm1lci9zeXNsb2ctZGVjb2Rlcic7XG5pbXBvcnQgeyBLQiB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5cbi8vV2UganVzdCBuZWVkIHRvIHdyaXRlIGFueSBkYXRhIHRvIHRoZSBjbGllbnQuIEl0IGRvZXNuJ3QgbWF0dGVyIHdoYXQgd2Ugc2VuZFxuY29uc3QgU1lTTE9HX1NFUlZJQ0VfTkFNRSA9ICdjb20uYXBwbGUuc3lzbG9nX3JlbGF5JztcbmNvbnN0IFNUQVJUX01FU1NBR0UgPSAnc3RhcnQnO1xuXG5jbGFzcyBTeXNsb2dTZXJ2aWNlIHtcblxuICBjb25zdHJ1Y3RvciAoc29ja2V0Q2xpZW50KSB7XG4gICAgdGhpcy5fc29ja2V0Q2xpZW50ID0gc29ja2V0Q2xpZW50O1xuICAgIHRoaXMuX2RlY29kZXIgPSBuZXcgU3lzbG9nRGVjb2Rlcig1ICogS0IpO1xuICAgIHRoaXMuX3NvY2tldENsaWVudC5waXBlKHRoaXMuX2RlY29kZXIpO1xuXG4gIH1cbiAgc3RhcnQgKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5fZGVjb2Rlci5vbignZGF0YScsIGNhbGxiYWNrKTtcbiAgICB0aGlzLl9zb2NrZXRDbGllbnQud3JpdGUoU1RBUlRfTUVTU0FHRSk7XG4gIH1cblxuICBjbG9zZSAoKSB7XG4gICAgdGhpcy5fc29ja2V0Q2xpZW50LmRlc3Ryb3koKTtcbiAgfVxuXG59XG5cbmV4cG9ydCB7IFN5c2xvZ1NlcnZpY2UsIFNZU0xPR19TRVJWSUNFX05BTUUgfTtcbmV4cG9ydCBkZWZhdWx0IFN5c2xvZ1NlcnZpY2U7Il0sImZpbGUiOiJsaWIvc3lzbG9nL2luZGV4LmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=

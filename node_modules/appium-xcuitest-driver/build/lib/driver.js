"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.XCUITestDriver = exports.default = void 0;

require("source-map-support/register");

var _appiumBaseDriver = require("appium-base-driver");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _url = _interopRequireDefault(require("url"));

var _nodeSimctl = require("node-simctl");

var _webdriveragent = _interopRequireDefault(require("./wda/webdriveragent"));

var _logger = _interopRequireDefault(require("./logger"));

var _simulatorManagement = require("./simulator-management");

var _appiumIosSimulator = require("appium-ios-simulator");

var _asyncbox = require("asyncbox");

var _appiumIosDriver = require("appium-ios-driver");

var _desiredCaps = require("./desired-caps");

var _index = _interopRequireDefault(require("./commands/index"));

var _utils = require("./utils");

var _realDeviceManagement = require("./real-device-management");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _asyncLock = _interopRequireDefault(require("async-lock"));

var _path = _interopRequireDefault(require("path"));

var _appiumIdb = _interopRequireDefault(require("appium-idb"));

const SHUTDOWN_OTHER_FEAT_NAME = 'shutdown_other_sims';
const SAFARI_BUNDLE_ID = 'com.apple.mobilesafari';
const WDA_SIM_STARTUP_RETRIES = 2;
const WDA_REAL_DEV_STARTUP_RETRIES = 1;
const WDA_REAL_DEV_TUTORIAL_URL = 'https://github.com/appium/appium-xcuitest-driver/blob/master/docs/real-device-config.md';
const WDA_STARTUP_RETRY_INTERVAL = 10000;
const DEFAULT_SETTINGS = {
  nativeWebTap: false,
  useJSONSource: false,
  shouldUseCompactResponses: true,
  elementResponseAttributes: 'type,label',
  mjpegServerScreenshotQuality: 25,
  mjpegServerFramerate: 10,
  screenshotQuality: 1,
  mjpegScalingFactor: 100
};
const SHARED_RESOURCES_GUARD = new _asyncLock.default();
const NO_PROXY_NATIVE_LIST = [['DELETE', /window/], ['GET', /^\/session\/[^\/]+$/], ['GET', /alert_text/], ['GET', /alert\/[^\/]+/], ['GET', /appium/], ['GET', /attribute/], ['GET', /context/], ['GET', /location/], ['GET', /log/], ['GET', /screenshot/], ['GET', /size/], ['GET', /source/], ['GET', /url/], ['GET', /window/], ['POST', /accept_alert/], ['POST', /actions$/], ['POST', /alert_text/], ['POST', /alert\/[^\/]+/], ['POST', /appium/], ['POST', /appium\/device\/is_locked/], ['POST', /appium\/device\/lock/], ['POST', /appium\/device\/unlock/], ['POST', /back/], ['POST', /clear/], ['POST', /context/], ['POST', /dismiss_alert/], ['POST', /element\/active/], ['POST', /element$/], ['POST', /elements$/], ['POST', /execute/], ['POST', /keys/], ['POST', /log/], ['POST', /moveto/], ['POST', /receive_async_response/], ['POST', /session\/[^\/]+\/location/], ['POST', /shake/], ['POST', /timeouts/], ['POST', /touch/], ['POST', /url/], ['POST', /value/], ['POST', /window/]];
const NO_PROXY_WEB_LIST = [['DELETE', /cookie/], ['GET', /attribute/], ['GET', /cookie/], ['GET', /element/], ['GET', /text/], ['GET', /title/], ['POST', /clear/], ['POST', /click/], ['POST', /cookie/], ['POST', /element/], ['POST', /forward/], ['POST', /frame/], ['POST', /keys/], ['POST', /refresh/]].concat(NO_PROXY_NATIVE_LIST);
const MEMOIZED_FUNCTIONS = ['getStatusBarHeight', 'getDevicePixelRatio', 'getScreenInfo', 'getSafariIsIphone', 'getSafariIsIphoneX'];

class XCUITestDriver extends _appiumBaseDriver.BaseDriver {
  constructor(opts = {}, shouldValidateCaps = true) {
    super(opts, shouldValidateCaps);
    this.desiredCapConstraints = _desiredCaps.desiredCapConstraints;
    this.locatorStrategies = ['xpath', 'id', 'name', 'class name', '-ios predicate string', '-ios class chain', 'accessibility id'];
    this.webLocatorStrategies = ['link text', 'css selector', 'tag name', 'link text', 'partial link text'];
    this.resetIos();
    this.settings = new _appiumBaseDriver.DeviceSettings(DEFAULT_SETTINGS, this.onSettingsUpdate.bind(this));
    this.logs = {};

    for (const fn of MEMOIZED_FUNCTIONS) {
      this[fn] = _lodash.default.memoize(this[fn]);
    }
  }

  async onSettingsUpdate(key, value) {
    if (key !== 'nativeWebTap') {
      return await this.proxyCommand('/appium/settings', 'POST', {
        settings: {
          [key]: value
        }
      });
    }

    this.opts.nativeWebTap = !!value;
  }

  resetIos() {
    this.opts = this.opts || {};
    this.wda = null;
    this.opts.device = null;
    this.jwpProxyActive = false;
    this.proxyReqRes = null;
    this.jwpProxyAvoid = [];
    this.safari = false;
    this.cachedWdaStatus = null;
    this.curWebFrames = [];
    this.webElementIds = [];
    this._currentUrl = null;
    this.curContext = null;
    this.xcodeVersion = {};
    this.contexts = [];
    this.implicitWaitMs = 0;
    this.asynclibWaitMs = 0;
    this.pageLoadMs = 6000;
    this.landscapeWebCoordsOffset = 0;
  }

  get driverData() {
    return {};
  }

  async getStatus() {
    if (typeof this.driverInfo === 'undefined') {
      this.driverInfo = await (0, _utils.getDriverInfo)();
    }

    let status = {
      build: {
        version: this.driverInfo.version
      }
    };

    if (this.cachedWdaStatus) {
      status.wda = this.cachedWdaStatus;
    }

    return status;
  }

  async createSession(...args) {
    this.lifecycleData = {};

    try {
      let [sessionId, caps] = await super.createSession(...args);
      this.opts.sessionId = sessionId;
      await this.start();
      caps = Object.assign({}, _appiumIosDriver.defaultServerCaps, caps);
      caps.udid = this.opts.udid;

      if (_lodash.default.has(this.opts, 'nativeWebTap')) {
        await this.updateSettings({
          nativeWebTap: this.opts.nativeWebTap
        });
      }

      if (_lodash.default.has(this.opts, 'useJSONSource')) {
        await this.updateSettings({
          useJSONSource: this.opts.useJSONSource
        });
      }

      let wdaSettings = {
        elementResponseAttributes: DEFAULT_SETTINGS.elementResponseAttributes,
        shouldUseCompactResponses: DEFAULT_SETTINGS.shouldUseCompactResponses
      };

      if (_lodash.default.has(this.opts, 'elementResponseAttributes')) {
        wdaSettings.elementResponseAttributes = this.opts.elementResponseAttributes;
      }

      if (_lodash.default.has(this.opts, 'shouldUseCompactResponses')) {
        wdaSettings.shouldUseCompactResponses = this.opts.shouldUseCompactResponses;
      }

      if (_lodash.default.has(this.opts, 'mjpegServerScreenshotQuality')) {
        wdaSettings.mjpegServerScreenshotQuality = this.opts.mjpegServerScreenshotQuality;
      }

      if (_lodash.default.has(this.opts, 'mjpegServerFramerate')) {
        wdaSettings.mjpegServerFramerate = this.opts.mjpegServerFramerate;
      }

      if (_lodash.default.has(this.opts, 'screenshotQuality')) {
        _logger.default.info(`Setting the quality of phone screenshot: '${this.opts.screenshotQuality}'`);

        wdaSettings.screenshotQuality = this.opts.screenshotQuality;
      }

      await this.updateSettings(wdaSettings);

      if (this.opts.mjpegScreenshotUrl) {
        _logger.default.info(`Starting MJPEG stream reading URL: '${this.opts.mjpegScreenshotUrl}'`);

        this.mjpegStream = new _appiumSupport.mjpeg.MJpegStream(this.opts.mjpegScreenshotUrl);
        await this.mjpegStream.start();
      }

      return [sessionId, caps];
    } catch (e) {
      _logger.default.error(e);

      await this.deleteSession();
      throw e;
    }
  }

  async start() {
    this.opts.noReset = !!this.opts.noReset;
    this.opts.fullReset = !!this.opts.fullReset;
    await (0, _utils.printUser)();
    this.opts.iosSdkVersion = null;
    const {
      device,
      udid,
      realDevice
    } = await this.determineDevice();

    _logger.default.info(`Determining device to run tests on: udid: '${udid}', real device: ${realDevice}`);

    this.opts.device = device;
    this.opts.udid = udid;
    this.opts.realDevice = realDevice;
    const normalizedVersion = (0, _utils.normalizePlatformVersion)(this.opts.platformVersion);

    if (this.opts.platformVersion !== normalizedVersion) {
      _logger.default.info(`Normalized platformVersion capability value '${this.opts.platformVersion}' to '${normalizedVersion}'`);

      this.opts.platformVersion = normalizedVersion;
    }

    if (_appiumSupport.util.compareVersions(this.opts.platformVersion, '<', '9.3')) {
      throw new Error(`Platform version must be 9.3 or above. '${this.opts.platformVersion}' is not supported.`);
    }

    if (_lodash.default.isEmpty(this.xcodeVersion) && (!this.opts.webDriverAgentUrl || !this.opts.realDevice)) {
      this.xcodeVersion = await (0, _utils.getAndCheckXcodeVersion)();
    }

    this.logEvent('xcodeDetailsRetrieved');

    if (this.opts.enableAsyncExecuteFromHttps && !this.isRealDevice()) {
      await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
      await this.startHttpsAsyncServer();
    }

    if (!this.opts.platformVersion) {
      if (this.opts.device && _lodash.default.isFunction(this.opts.device.getPlatformVersion)) {
        this.opts.platformVersion = await this.opts.device.getPlatformVersion();

        _logger.default.info(`No platformVersion specified. Using device version: '${this.opts.platformVersion}'`);
      } else {}
    }

    if ((this.opts.browserName || '').toLowerCase() === 'safari') {
      _logger.default.info('Safari test requested');

      this.safari = true;
      this.opts.app = undefined;
      this.opts.processArguments = this.opts.processArguments || {};
      this.opts.bundleId = SAFARI_BUNDLE_ID;
      this._currentUrl = this.opts.safariInitialUrl || (this.isRealDevice() ? 'http://appium.io' : `http://${this.opts.address}:${this.opts.port}/welcome`);

      if (_appiumSupport.util.compareVersions(this.opts.platformVersion, '<', '12.2')) {
        this.opts.processArguments.args = ['-u', this._currentUrl];
      }
    } else {
      await this.configureApp();
    }

    this.logEvent('appConfigured');

    if (this.opts.app) {
      await (0, _utils.checkAppPresent)(this.opts.app);
    }

    if (!this.opts.bundleId) {
      this.opts.bundleId = await _appiumIosDriver.appUtils.extractBundleId(this.opts.app);
    }

    await this.runReset();

    const memoizedLogInfo = _lodash.default.memoize(function logInfo() {
      _logger.default.info("'skipLogCapture' is set. Skipping starting logs such as crash, system, safari console and safari network.");
    });

    const startLogCapture = async () => {
      if (this.opts.skipLogCapture) {
        memoizedLogInfo();
        return false;
      }

      const result = await this.startLogCapture();

      if (result) {
        this.logEvent('logCaptureStarted');
      }

      return result;
    };

    const isLogCaptureStarted = await startLogCapture();

    _logger.default.info(`Setting up ${this.isRealDevice() ? 'real device' : 'simulator'}`);

    if (this.isSimulator()) {
      if (this.opts.shutdownOtherSimulators) {
        this.ensureFeatureEnabled(SHUTDOWN_OTHER_FEAT_NAME);
        await (0, _simulatorManagement.shutdownOtherSimulators)(this.opts.device);
      }

      if (_appiumSupport.util.hasValue(this.opts.reduceMotion)) {
        await this.opts.device.setReduceMotion(this.opts.reduceMotion);
      }

      this.localConfig = await _appiumIosDriver.settings.setLocaleAndPreferences(this.opts.device, this.opts, this.isSafari(), async sim => {
        await (0, _simulatorManagement.shutdownSimulator)(sim);
        await _appiumIosDriver.settings.setLocaleAndPreferences(sim, this.opts, this.isSafari());
      });
      await this.startSim();

      if (this.opts.customSSLCert) {
        if (await (0, _appiumIosSimulator.hasSSLCert)(this.opts.customSSLCert, this.opts.udid)) {
          _logger.default.info(`SSL cert '${_lodash.default.truncate(this.opts.customSSLCert, {
            length: 20
          })}' already installed`);
        } else {
          _logger.default.info(`Installing ssl cert '${_lodash.default.truncate(this.opts.customSSLCert, {
            length: 20
          })}'`);

          await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
          await (0, _appiumIosSimulator.installSSLCert)(this.opts.customSSLCert, this.opts.udid);

          _logger.default.info(`Restarting Simulator so that SSL certificate installation takes effect`);

          await this.startSim();
          this.logEvent('customCertInstalled');
        }
      }

      try {
        const idb = new _appiumIdb.default({
          udid
        });
        await idb.connect();
        this.opts.device.idb = idb;
      } catch (e) {
        _logger.default.info(`idb will not be used for Simulator interaction. Original error: ${e.message}`);
      }

      this.logEvent('simStarted');

      if (!isLogCaptureStarted) {
        await startLogCapture();
      }
    }

    if (this.opts.app) {
      await this.installAUT();
      this.logEvent('appInstalled');
    }

    if (!this.opts.app && this.opts.bundleId && !this.safari) {
      if (!(await this.opts.device.isAppInstalled(this.opts.bundleId))) {
        _logger.default.errorAndThrow(`App with bundle identifier '${this.opts.bundleId}' unknown`);
      }
    }

    if (this.opts.permissions) {
      if (this.isSimulator()) {
        _logger.default.debug('Setting the requested permissions before WDA is started');

        for (const [bundleId, permissionsMapping] of _lodash.default.toPairs(JSON.parse(this.opts.permissions))) {
          await this.opts.device.setPermissions(bundleId, permissionsMapping);
        }
      } else {
        _logger.default.warn('Setting permissions is only supported on Simulator. ' + 'The "permissions" capability will be ignored.');
      }
    }

    await this.startWda(this.opts.sessionId, realDevice);
    await this.setInitialOrientation(this.opts.orientation);
    this.logEvent('orientationSet');

    if (this.isSafari() && !this.isRealDevice() && _appiumSupport.util.compareVersions(this.opts.platformVersion, '>=', '12.2')) {
      await (0, _nodeSimctl.openUrl)(this.opts.device.udid, this._currentUrl);
    }

    if (this.isRealDevice() && this.opts.startIWDP) {
      try {
        await this.startIWDP();

        _logger.default.debug(`Started ios_webkit_debug proxy server at: ${this.iwdpServer.endpoint}`);
      } catch (err) {
        _logger.default.errorAndThrow(`Could not start ios_webkit_debug_proxy server: ${err.message}`);
      }
    }

    if (this.isSafari() || this.opts.autoWebview) {
      _logger.default.debug('Waiting for initial webview');

      await this.navToInitialWebview();
      this.logEvent('initialWebviewNavigated');
    }

    if (this.isSafari() && this.isRealDevice() && _appiumSupport.util.compareVersions(this.opts.platformVersion, '>=', '12.2')) {
      await this.setUrl(this._currentUrl);
    }

    if (!this.isRealDevice()) {
      if (this.opts.calendarAccessAuthorized) {
        await this.opts.device.enableCalendarAccess(this.opts.bundleId);
      } else if (this.opts.calendarAccessAuthorized === false) {
        await this.opts.device.disableCalendarAccess(this.opts.bundleId);
      }
    }
  }

  async startWda(sessionId, realDevice) {
    this.wda = new _webdriveragent.default(this.xcodeVersion, this.opts);

    if (!_appiumSupport.util.hasValue(this.wda.webDriverAgentUrl)) {
      await this.wda.cleanupObsoleteProcesses();
    }

    const synchronizationKey = !this.opts.useXctestrunFile && (await this.wda.isSourceFresh()) ? XCUITestDriver.name : _path.default.normalize((await this.wda.retrieveDerivedDataPath()));

    _logger.default.debug(`Starting WebDriverAgent initialization with the synchronization key '${synchronizationKey}'`);

    if (SHARED_RESOURCES_GUARD.isBusy() && !this.opts.derivedDataPath && !this.opts.bootstrapPath) {
      _logger.default.debug(`Consider setting a unique 'derivedDataPath' capability value for each parallel driver instance ` + `to avoid conflicts and speed up the building process`);
    }

    return await SHARED_RESOURCES_GUARD.acquire(synchronizationKey, async () => {
      if (this.opts.useNewWDA) {
        _logger.default.debug(`Capability 'useNewWDA' set to true, so uninstalling WDA before proceeding`);

        await this.wda.quitAndUninstall();
        this.logEvent('wdaUninstalled');
      } else if (!_appiumSupport.util.hasValue(this.wda.webDriverAgentUrl)) {
        await this.wda.setupCaching(this.opts.updatedWDABundleId);
      }

      const quitAndUninstall = async msg => {
        _logger.default.debug(msg);

        if (this.opts.webDriverAgentUrl) {
          _logger.default.debug('Not quitting/uninstalling WebDriverAgent since webDriverAgentUrl capability is provided');

          throw new Error(msg);
        }

        _logger.default.warn('Quitting and uninstalling WebDriverAgent');

        await this.wda.quitAndUninstall();
        throw new Error(msg);
      };

      const startupRetries = this.opts.wdaStartupRetries || (this.isRealDevice() ? WDA_REAL_DEV_STARTUP_RETRIES : WDA_SIM_STARTUP_RETRIES);
      const startupRetryInterval = this.opts.wdaStartupRetryInterval || WDA_STARTUP_RETRY_INTERVAL;

      _logger.default.debug(`Trying to start WebDriverAgent ${startupRetries} times with ${startupRetryInterval}ms interval`);

      if (!_appiumSupport.util.hasValue(this.opts.wdaStartupRetries) && !_appiumSupport.util.hasValue(this.opts.wdaStartupRetryInterval)) {
        _logger.default.debug(`These values can be customized by changing wdaStartupRetries/wdaStartupRetryInterval capabilities`);
      }

      let retryCount = 0;
      await (0, _asyncbox.retryInterval)(startupRetries, startupRetryInterval, async () => {
        this.logEvent('wdaStartAttempted');

        if (retryCount > 0) {
          _logger.default.info(`Retrying WDA startup (${retryCount + 1} of ${startupRetries})`);
        }

        try {
          const retries = this.xcodeVersion.major >= 10 ? 2 : 1;
          this.cachedWdaStatus = await (0, _asyncbox.retry)(retries, this.wda.launch.bind(this.wda), sessionId, realDevice);
        } catch (err) {
          this.logEvent('wdaStartFailed');
          retryCount++;
          let errorMsg = `Unable to launch WebDriverAgent because of xcodebuild failure: ${err.message}`;

          if (this.isRealDevice()) {
            errorMsg += `. Make sure you follow the tutorial at ${WDA_REAL_DEV_TUTORIAL_URL}. ` + `Try to remove the WebDriverAgentRunner application from the device if it is installed ` + `and reboot the device.`;
          }

          await quitAndUninstall(errorMsg);
        }

        this.proxyReqRes = this.wda.proxyReqRes.bind(this.wda);
        this.jwpProxyActive = true;
        let originalStacktrace = null;

        try {
          await (0, _asyncbox.retryInterval)(15, 1000, async () => {
            this.logEvent('wdaSessionAttempted');

            _logger.default.debug('Sending createSession command to WDA');

            try {
              this.cachedWdaStatus = this.cachedWdaStatus || (await this.proxyCommand('/status', 'GET'));
              await this.startWdaSession(this.opts.bundleId, this.opts.processArguments);
            } catch (err) {
              originalStacktrace = err.stack;

              _logger.default.debug(`Failed to create WDA session (${err.message}). Retrying...`);

              throw err;
            }
          });
          this.logEvent('wdaSessionStarted');
        } catch (err) {
          if (originalStacktrace) {
            _logger.default.debug(originalStacktrace);
          }

          let errorMsg = `Unable to start WebDriverAgent session because of xcodebuild failure: ${err.message}`;

          if (this.isRealDevice()) {
            errorMsg += ` Make sure you follow the tutorial at ${WDA_REAL_DEV_TUTORIAL_URL}. ` + `Try to remove the WebDriverAgentRunner application from the device if it is installed ` + `and reboot the device.`;
          }

          await quitAndUninstall(errorMsg);
        }

        if (this.opts.clearSystemFiles && !this.opts.webDriverAgentUrl) {
          await (0, _utils.markSystemFilesForCleanup)(this.wda);
        }

        this.wda.fullyStarted = true;
        this.logEvent('wdaStarted');
      });
    });
  }

  async runReset(opts = null) {
    this.logEvent('resetStarted');

    if (this.isRealDevice()) {
      await (0, _realDeviceManagement.runRealDeviceReset)(this.opts.device, opts || this.opts);
    } else {
      await (0, _simulatorManagement.runSimulatorReset)(this.opts.device, opts || this.opts);
    }

    this.logEvent('resetComplete');
  }

  async deleteSession() {
    await (0, _utils.removeAllSessionWebSocketHandlers)(this.server, this.sessionId);

    if (this.isSimulator() && (this.opts.device || {}).idb) {
      await this.opts.device.idb.disconnect();
      this.opts.device.idb = null;
    }

    await this.stop();

    if (this.opts.clearSystemFiles && this.isAppTemporary) {
      await _appiumSupport.fs.rimraf(this.opts.app);
    }

    if (this.wda && !this.opts.webDriverAgentUrl) {
      const synchronizationKey = _path.default.normalize((await this.wda.retrieveDerivedDataPath()));

      await SHARED_RESOURCES_GUARD.acquire(synchronizationKey, async () => {
        if (this.opts.clearSystemFiles) {
          await (0, _utils.clearSystemFiles)(this.wda);
        } else {
          _logger.default.debug('Not clearing log files. Use `clearSystemFiles` capability to turn on.');
        }
      });
    }

    if (this.isWebContext()) {
      _logger.default.debug('In a web session. Removing remote debugger');

      await this.stopRemote();
    }

    if (this.opts.resetOnSessionStartOnly === false) {
      await this.runReset(Object.assign({}, this.opts, {
        enforceSimulatorShutdown: true
      }));
    }

    if (this.isSimulator() && !this.opts.noReset && !!this.opts.device) {
      if (this.lifecycleData.createSim) {
        _logger.default.debug(`Deleting simulator created for this run (udid: '${this.opts.udid}')`);

        await (0, _simulatorManagement.shutdownSimulator)(this.opts.device);
        await this.opts.device.delete();
      }
    }

    if (!_lodash.default.isEmpty(this.logs)) {
      await this.logs.syslog.stopCapture();
      this.logs = {};
    }

    if (this.iwdpServer) {
      await this.stopIWDP();
    }

    if (this.opts.enableAsyncExecuteFromHttps && !this.isRealDevice()) {
      await this.stopHttpsAsyncServer();
    }

    if (this.mjpegStream) {
      _logger.default.info('Closing MJPEG stream');

      this.mjpegStream.stop();
    }

    this.resetIos();
    await super.deleteSession();
  }

  async stop() {
    this.jwpProxyActive = false;
    this.proxyReqRes = null;

    if (this.wda && this.wda.fullyStarted) {
      if (this.wda.jwproxy) {
        try {
          await this.proxyCommand(`/session/${this.sessionId}`, 'DELETE');
        } catch (err) {
          _logger.default.debug(`Unable to DELETE session on WDA: '${err.message}'. Continuing shutdown.`);
        }
      }

      if (this.wda && !this.wda.webDriverAgentUrl && this.opts.useNewWDA) {
        await this.wda.quit();
      }
    }
  }

  async executeCommand(cmd, ...args) {
    _logger.default.debug(`Executing command '${cmd}'`);

    if (cmd === 'receiveAsyncResponse') {
      return await this.receiveAsyncResponse(...args);
    }

    if (cmd === 'getStatus') {
      return await this.getStatus();
    }

    return await super.executeCommand(cmd, ...args);
  }

  async configureApp() {
    function appIsPackageOrBundle(app) {
      return /^([a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+)+$/.test(app);
    }

    if (!this.opts.bundleId && appIsPackageOrBundle(this.opts.app)) {
      this.opts.bundleId = this.opts.app;
      this.opts.app = '';
    }

    if (this.opts.bundleId && appIsPackageOrBundle(this.opts.bundleId) && (this.opts.app === '' || appIsPackageOrBundle(this.opts.app))) {
      _logger.default.debug('App is an iOS bundle, will attempt to run as pre-existing');

      return;
    }

    if (this.opts.app && this.opts.app.toLowerCase() === 'settings') {
      this.opts.bundleId = 'com.apple.Preferences';
      this.opts.app = null;
      return;
    } else if (this.opts.app && this.opts.app.toLowerCase() === 'calendar') {
      this.opts.bundleId = 'com.apple.mobilecal';
      this.opts.app = null;
      return;
    }

    const originalAppPath = this.opts.app;

    try {
      this.opts.app = await this.helpers.configureApp(this.opts.app, '.app');
    } catch (err) {
      _logger.default.error(err);

      throw new Error(`Bad app: ${this.opts.app}. App paths need to be absolute or an URL to a compressed app file${err && err.message ? `: ${err.message}` : ''}`);
    }

    this.isAppTemporary = this.opts.app && (await _appiumSupport.fs.exists(this.opts.app)) && !(await _appiumSupport.util.isSameDestination(originalAppPath, this.opts.app));
  }

  async determineDevice() {
    this.lifecycleData.createSim = false;
    this.opts.deviceName = (0, _utils.translateDeviceName)(this.opts.platformVersion, this.opts.deviceName);

    const setupVersionCaps = async () => {
      this.opts.iosSdkVersion = await (0, _utils.getAndCheckIosSdkVersion)();

      _logger.default.info(`iOS SDK Version set to '${this.opts.iosSdkVersion}'`);

      if (!this.opts.platformVersion && this.opts.iosSdkVersion) {
        _logger.default.info(`No platformVersion specified. Using the latest version Xcode supports: '${this.opts.iosSdkVersion}'. ` + `This may cause problems if a simulator does not exist for this platform version.`);

        this.opts.platformVersion = (0, _utils.normalizePlatformVersion)(this.opts.iosSdkVersion);
      }
    };

    if (this.opts.udid) {
      if (this.opts.udid.toLowerCase() === 'auto') {
        try {
          this.opts.udid = await (0, _utils.detectUdid)();
        } catch (err) {
          _logger.default.warn(`Cannot detect any connected real devices. Falling back to Simulator. Original error: ${err.message}`);

          const device = await (0, _simulatorManagement.getExistingSim)(this.opts);

          if (!device) {
            _logger.default.errorAndThrow(`Cannot detect udid for ${this.opts.deviceName} Simulator running iOS ${this.opts.platformVersion}`);
          }

          this.opts.udid = device.udid;
          const devicePlatform = (0, _utils.normalizePlatformVersion)((await device.getPlatformVersion()));

          if (this.opts.platformVersion !== devicePlatform) {
            this.opts.platformVersion = devicePlatform;

            _logger.default.info(`Set platformVersion to '${devicePlatform}' to match the device with given UDID`);
          }

          await setupVersionCaps();
          return {
            device,
            realDevice: false,
            udid: device.udid
          };
        }
      } else {
        const devices = await (0, _realDeviceManagement.getConnectedDevices)();

        _logger.default.debug(`Available devices: ${devices.join(', ')}`);

        if (!devices.includes(this.opts.udid)) {
          if (await (0, _appiumIosSimulator.simExists)(this.opts.udid)) {
            const device = await (0, _appiumIosSimulator.getSimulator)(this.opts.udid);
            return {
              device,
              realDevice: false,
              udid: this.opts.udid
            };
          }

          throw new Error(`Unknown device or simulator UDID: '${this.opts.udid}'`);
        }
      }

      const device = await (0, _realDeviceManagement.getRealDeviceObj)(this.opts.udid);

      if (_lodash.default.isEmpty(this.opts.platformVersion)) {
        _logger.default.info('Getting the platformVersion from the phone since it was not specified in the capabilities');

        try {
          const osVersion = await (0, _realDeviceManagement.getOSVersion)(this.opts.udid);
          this.opts.platformVersion = _appiumSupport.util.coerceVersion(osVersion);
        } catch (e) {
          _logger.default.warn(`Cannot determine real device platform version. Original error: ${e.message}`);
        }
      }

      return {
        device,
        realDevice: true,
        udid: this.opts.udid
      };
    }

    await setupVersionCaps();

    if (this.opts.enforceFreshSimulatorCreation) {
      _logger.default.debug(`New simulator is requested. If this is not wanted, set 'enforceFreshSimulatorCreation' capability to false`);
    } else {
      const device = await (0, _simulatorManagement.getExistingSim)(this.opts);

      if (device) {
        return {
          device,
          realDevice: false,
          udid: device.udid
        };
      }

      _logger.default.info('Simulator udid not provided');
    }

    _logger.default.info('Using desired caps to create a new simulator');

    const device = await this.createSim();
    return {
      device,
      realDevice: false,
      udid: device.udid
    };
  }

  async startSim() {
    const runOpts = {
      scaleFactor: this.opts.scaleFactor,
      connectHardwareKeyboard: !!this.opts.connectHardwareKeyboard,
      isHeadless: !!this.opts.isHeadless,
      devicePreferences: {}
    };

    if (this.opts.SimulatorWindowCenter) {
      runOpts.devicePreferences.SimulatorWindowCenter = this.opts.SimulatorWindowCenter;
    }

    const orientation = _lodash.default.isString(this.opts.orientation) && this.opts.orientation.toUpperCase();

    switch (orientation) {
      case 'LANDSCAPE':
        runOpts.devicePreferences.SimulatorWindowOrientation = 'LandscapeLeft';
        runOpts.devicePreferences.SimulatorWindowRotationAngle = 90;
        break;

      case 'PORTRAIT':
        runOpts.devicePreferences.SimulatorWindowOrientation = 'Portrait';
        runOpts.devicePreferences.SimulatorWindowRotationAngle = 0;
        break;
    }

    await this.opts.device.run(runOpts);
  }

  async createSim() {
    this.lifecycleData.createSim = true;
    const platformName = (0, _utils.isTvOS)(this.opts.platformName) ? _desiredCaps.PLATFORM_NAME_TVOS : _desiredCaps.PLATFORM_NAME_IOS;
    let sim = await (0, _simulatorManagement.createSim)(this.opts, platformName);

    _logger.default.info(`Created simulator with udid '${sim.udid}'.`);

    return sim;
  }

  async launchApp() {
    const APP_LAUNCH_TIMEOUT = 20 * 1000;
    this.logEvent('appLaunchAttempted');
    await (0, _nodeSimctl.launch)(this.opts.device.udid, this.opts.bundleId);

    let checkStatus = async () => {
      let response = await this.proxyCommand('/status', 'GET');
      let currentApp = response.currentApp.bundleID;

      if (currentApp !== this.opts.bundleId) {
        throw new Error(`${this.opts.bundleId} not in foreground. ${currentApp} is in foreground`);
      }
    };

    _logger.default.info(`Waiting for '${this.opts.bundleId}' to be in foreground`);

    let retries = parseInt(APP_LAUNCH_TIMEOUT / 200, 10);
    await (0, _asyncbox.retryInterval)(retries, 200, checkStatus);

    _logger.default.info(`${this.opts.bundleId} is in foreground`);

    this.logEvent('appLaunched');
  }

  async startWdaSession(bundleId, processArguments) {
    let args = processArguments ? processArguments.args || [] : [];

    if (!_lodash.default.isArray(args)) {
      throw new Error(`processArguments.args capability is expected to be an array. ` + `${JSON.stringify(args)} is given instead`);
    }

    let env = processArguments ? processArguments.env || {} : {};

    if (!_lodash.default.isPlainObject(env)) {
      throw new Error(`processArguments.env capability is expected to be a dictionary. ` + `${JSON.stringify(env)} is given instead`);
    }

    let shouldWaitForQuiescence = _appiumSupport.util.hasValue(this.opts.waitForQuiescence) ? this.opts.waitForQuiescence : true;
    let maxTypingFrequency = _appiumSupport.util.hasValue(this.opts.maxTypingFrequency) ? this.opts.maxTypingFrequency : 60;
    let shouldUseSingletonTestManager = _appiumSupport.util.hasValue(this.opts.shouldUseSingletonTestManager) ? this.opts.shouldUseSingletonTestManager : true;
    let shouldUseTestManagerForVisibilityDetection = false;
    let eventloopIdleDelaySec = this.opts.wdaEventloopIdleDelay || 0;

    if (_appiumSupport.util.hasValue(this.opts.simpleIsVisibleCheck)) {
      shouldUseTestManagerForVisibilityDetection = this.opts.simpleIsVisibleCheck;
    }

    if (_appiumSupport.util.compareVersions(this.opts.platformVersion, '==', '9.3')) {
      _logger.default.info(`Forcing shouldUseSingletonTestManager capability value to true, because of known XCTest issues under 9.3 platform version`);

      shouldUseTestManagerForVisibilityDetection = true;
    }

    if (_appiumSupport.util.hasValue(this.opts.language)) {
      args.push('-AppleLanguages', `(${this.opts.language})`);
      args.push('-NSLanguages', `(${this.opts.language})`);
    }

    if (_appiumSupport.util.hasValue(this.opts.locale)) {
      args.push('-AppleLocale', this.opts.locale);
    }

    let desired = {
      desiredCapabilities: {
        bundleId,
        arguments: args,
        environment: env,
        eventloopIdleDelaySec,
        shouldWaitForQuiescence,
        shouldUseTestManagerForVisibilityDetection,
        maxTypingFrequency,
        shouldUseSingletonTestManager
      }
    };

    if (_appiumSupport.util.hasValue(this.opts.shouldUseCompactResponses)) {
      desired.desiredCapabilities.shouldUseCompactResponses = this.opts.shouldUseCompactResponses;
    }

    if (_appiumSupport.util.hasValue(this.opts.elementResponseFields)) {
      desired.desiredCapabilities.elementResponseFields = this.opts.elementResponseFields;
    }

    if (this.opts.autoAcceptAlerts) {
      desired.desiredCapabilities.defaultAlertAction = 'accept';
    } else if (this.opts.autoDismissAlerts) {
      desired.desiredCapabilities.defaultAlertAction = 'dismiss';
    }

    await this.proxyCommand('/session', 'POST', desired);
  }

  proxyActive() {
    return this.jwpProxyActive;
  }

  getProxyAvoidList() {
    if (this.isWebview()) {
      return NO_PROXY_WEB_LIST;
    }

    return NO_PROXY_NATIVE_LIST;
  }

  canProxy() {
    return true;
  }

  isSafari() {
    return !!this.safari;
  }

  isRealDevice() {
    return this.opts.realDevice;
  }

  isSimulator() {
    return !this.opts.realDevice;
  }

  isWebview() {
    return this.isSafari() || this.isWebContext();
  }

  validateLocatorStrategy(strategy) {
    super.validateLocatorStrategy(strategy, this.isWebContext());
  }

  validateDesiredCaps(caps) {
    if (!super.validateDesiredCaps(caps)) {
      return false;
    }

    if ((caps.browserName || '').toLowerCase() !== 'safari' && !caps.app && !caps.bundleId) {
      let msg = 'The desired capabilities must include either an app or a bundleId for iOS';

      _logger.default.errorAndThrow(msg);
    }

    if (!_appiumSupport.util.coerceVersion(caps.platformVersion, false)) {
      _logger.default.warn(`'platformVersion' capability ('${caps.platformVersion}') is not a valid version number. ` + `Consider fixing it or be ready to experience an inconsistent driver behavior.`);
    }

    let verifyProcessArgument = processArguments => {
      const {
        args,
        env
      } = processArguments;

      if (!_lodash.default.isNil(args) && !_lodash.default.isArray(args)) {
        _logger.default.errorAndThrow('processArguments.args must be an array of strings');
      }

      if (!_lodash.default.isNil(env) && !_lodash.default.isPlainObject(env)) {
        _logger.default.errorAndThrow('processArguments.env must be an object <key,value> pair {a:b, c:d}');
      }
    };

    if (caps.processArguments) {
      if (_lodash.default.isString(caps.processArguments)) {
        try {
          caps.processArguments = JSON.parse(caps.processArguments);
          verifyProcessArgument(caps.processArguments);
        } catch (err) {
          _logger.default.errorAndThrow(`processArguments must be a json format or an object with format {args : [], env : {a:b, c:d}}. ` + `Both environment and argument can be null. Error: ${err}`);
        }
      } else if (_lodash.default.isPlainObject(caps.processArguments)) {
        verifyProcessArgument(caps.processArguments);
      } else {
        _logger.default.errorAndThrow(`'processArguments must be an object, or a string JSON object with format {args : [], env : {a:b, c:d}}. ` + `Both environment and argument can be null.`);
      }
    }

    if (caps.keychainPath && !caps.keychainPassword || !caps.keychainPath && caps.keychainPassword) {
      _logger.default.errorAndThrow(`If 'keychainPath' is set, 'keychainPassword' must also be set (and vice versa).`);
    }

    this.opts.resetOnSessionStartOnly = !_appiumSupport.util.hasValue(this.opts.resetOnSessionStartOnly) || this.opts.resetOnSessionStartOnly;
    this.opts.useNewWDA = _appiumSupport.util.hasValue(this.opts.useNewWDA) ? this.opts.useNewWDA : false;

    if (caps.commandTimeouts) {
      caps.commandTimeouts = (0, _utils.normalizeCommandTimeouts)(caps.commandTimeouts);
    }

    if (_lodash.default.isString(caps.webDriverAgentUrl)) {
      const {
        protocol,
        host
      } = _url.default.parse(caps.webDriverAgentUrl);

      if (_lodash.default.isEmpty(protocol) || _lodash.default.isEmpty(host)) {
        _logger.default.errorAndThrow(`'webDriverAgentUrl' capability is expected to contain a valid WebDriverAgent server URL. ` + `'${caps.webDriverAgentUrl}' is given instead`);
      }
    }

    if (caps.browserName) {
      if (caps.bundleId) {
        _logger.default.errorAndThrow(`'browserName' cannot be set together with 'bundleId' capability`);
      }

      if (caps.app) {
        _logger.default.warn(`The capabilities should generally not include both an 'app' and a 'browserName'`);
      }
    }

    if (caps.permissions) {
      try {
        for (const [bundleId, perms] of _lodash.default.toPairs(JSON.parse(caps.permissions))) {
          if (!_lodash.default.isString(bundleId)) {
            throw new Error(`'${JSON.stringify(bundleId)}' must be a string`);
          }

          if (!_lodash.default.isPlainObject(perms)) {
            throw new Error(`'${JSON.stringify(perms)}' must be a JSON object`);
          }
        }
      } catch (e) {
        _logger.default.errorAndThrow(`'${caps.permissions}' is expected to be a valid object with format ` + `{"<bundleId1>": {"<serviceName1>": "<serviceStatus1>", ...}, ...}. Original error: ${e.message}`);
      }
    }

    if (caps.platformVersion && !_appiumSupport.util.coerceVersion(caps.platformVersion, false)) {
      _logger.default.errorAndThrow(`'platformVersion' must be a valid version number. ` + `'${caps.platformVersion}' is given instead.`);
    }

    return true;
  }

  async installAUT() {
    if (this.isSafari()) {
      return;
    }

    if (this.opts.autoLaunch === false) {
      return;
    }

    try {
      await (0, _utils.verifyApplicationPlatform)(this.opts.app, this.isSimulator(), (0, _utils.isTvOS)(this.opts.platformName));
    } catch (err) {
      _logger.default.warn(`*********************************`);

      _logger.default.warn(`${this.isSimulator() ? 'Simulator' : 'Real device'} architecture appears to be unsupported ` + `by the '${this.opts.app}' application. ` + `Make sure the correct deployment target has been selected for its compilation in Xcode.`);

      _logger.default.warn('Don\'t be surprised if the application fails to launch.');

      _logger.default.warn(`*********************************`);
    }

    if (this.isRealDevice()) {
      await (0, _realDeviceManagement.installToRealDevice)(this.opts.device, this.opts.app, this.opts.bundleId, this.opts.noReset);
    } else {
      await (0, _simulatorManagement.installToSimulator)(this.opts.device, this.opts.app, this.opts.bundleId, this.opts.noReset);
    }

    if (this.opts.otherApps) {
      await this.installOtherApps(this.opts.otherApps);
    }

    if (_appiumSupport.util.hasValue(this.opts.iosInstallPause)) {
      let pause = parseInt(this.opts.iosInstallPause, 10);

      _logger.default.debug(`iosInstallPause set. Pausing ${pause} ms before continuing`);

      await _bluebird.default.delay(pause);
    }
  }

  async installOtherApps(otherApps) {
    if (this.isRealDevice()) {
      _logger.default.warn('Capability otherApps is only supported for Simulators');

      return;
    }

    try {
      otherApps = this.helpers.parseCapsArray(otherApps);
    } catch (e) {
      _logger.default.errorAndThrow(`Could not parse "otherApps" capability: ${e.message}`);
    }

    for (const otherApp of otherApps) {
      await (0, _simulatorManagement.installToSimulator)(this.opts.device, otherApp, undefined, this.opts.noReset);
    }
  }

  async setInitialOrientation(orientation) {
    if (!_lodash.default.isString(orientation)) {
      _logger.default.info('Skipping setting of the initial display orientation. ' + 'Set the "orientation" capability to either "LANDSCAPE" or "PORTRAIT", if this is an undesired behavior.');

      return;
    }

    orientation = orientation.toUpperCase();

    if (!_lodash.default.includes(['LANDSCAPE', 'PORTRAIT'], orientation)) {
      _logger.default.debug(`Unable to set initial orientation to '${orientation}'`);

      return;
    }

    _logger.default.debug(`Setting initial orientation to '${orientation}'`);

    try {
      await this.proxyCommand('/orientation', 'POST', {
        orientation
      });
      this.opts.curOrientation = orientation;
    } catch (err) {
      _logger.default.warn(`Setting initial orientation failed with: ${err.message}`);
    }
  }

  _getCommandTimeout(cmdName) {
    if (this.opts.commandTimeouts) {
      if (cmdName && _lodash.default.has(this.opts.commandTimeouts, cmdName)) {
        return this.opts.commandTimeouts[cmdName];
      }

      return this.opts.commandTimeouts[_utils.DEFAULT_TIMEOUT_KEY];
    }
  }

  async getSession() {
    const driverSession = await super.getSession();

    if (!this.wdaCaps) {
      this.wdaCaps = await this.proxyCommand('/', 'GET');
    }

    if (!this.deviceCaps) {
      const {
        statusBarSize,
        scale
      } = await this.getScreenInfo();
      this.deviceCaps = {
        pixelRatio: scale,
        statBarHeight: statusBarSize.height,
        viewportRect: await this.getViewportRect()
      };
    }

    _logger.default.info('Merging WDA caps over Appium caps for session detail response');

    return Object.assign({
      udid: this.opts.udid
    }, driverSession, this.wdaCaps.capabilities, this.deviceCaps);
  }

  async startIWDP() {
    this.logEvent('iwdpStarting');
    this.iwdpServer = new _appiumIosDriver.IWDP({
      webkitDebugProxyPort: this.opts.webkitDebugProxyPort,
      udid: this.opts.udid,
      logStdout: !!this.opts.showIWDPLog
    });
    await this.iwdpServer.start();
    this.logEvent('iwdpStarted');
  }

  async stopIWDP() {
    if (this.iwdpServer) {
      await this.iwdpServer.stop();
      delete this.iwdpServer;
    }
  }

  async reset() {
    if (this.opts.noReset) {
      let opts = _lodash.default.cloneDeep(this.opts);

      opts.noReset = false;
      opts.fullReset = false;
      const shutdownHandler = this.resetOnUnexpectedShutdown;

      this.resetOnUnexpectedShutdown = () => {};

      try {
        await this.runReset(opts);
      } finally {
        this.resetOnUnexpectedShutdown = shutdownHandler;
      }
    }

    await super.reset();
  }

}

exports.XCUITestDriver = XCUITestDriver;
Object.assign(XCUITestDriver.prototype, _index.default);
var _default = XCUITestDriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9kcml2ZXIuanMiXSwibmFtZXMiOlsiU0hVVERPV05fT1RIRVJfRkVBVF9OQU1FIiwiU0FGQVJJX0JVTkRMRV9JRCIsIldEQV9TSU1fU1RBUlRVUF9SRVRSSUVTIiwiV0RBX1JFQUxfREVWX1NUQVJUVVBfUkVUUklFUyIsIldEQV9SRUFMX0RFVl9UVVRPUklBTF9VUkwiLCJXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTCIsIkRFRkFVTFRfU0VUVElOR1MiLCJuYXRpdmVXZWJUYXAiLCJ1c2VKU09OU291cmNlIiwic2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyIsImVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMiLCJtanBlZ1NlcnZlclNjcmVlbnNob3RRdWFsaXR5IiwibWpwZWdTZXJ2ZXJGcmFtZXJhdGUiLCJzY3JlZW5zaG90UXVhbGl0eSIsIm1qcGVnU2NhbGluZ0ZhY3RvciIsIlNIQVJFRF9SRVNPVVJDRVNfR1VBUkQiLCJBc3luY0xvY2siLCJOT19QUk9YWV9OQVRJVkVfTElTVCIsIk5PX1BST1hZX1dFQl9MSVNUIiwiY29uY2F0IiwiTUVNT0laRURfRlVOQ1RJT05TIiwiWENVSVRlc3REcml2ZXIiLCJCYXNlRHJpdmVyIiwiY29uc3RydWN0b3IiLCJvcHRzIiwic2hvdWxkVmFsaWRhdGVDYXBzIiwiZGVzaXJlZENhcENvbnN0cmFpbnRzIiwibG9jYXRvclN0cmF0ZWdpZXMiLCJ3ZWJMb2NhdG9yU3RyYXRlZ2llcyIsInJlc2V0SW9zIiwic2V0dGluZ3MiLCJEZXZpY2VTZXR0aW5ncyIsIm9uU2V0dGluZ3NVcGRhdGUiLCJiaW5kIiwibG9ncyIsImZuIiwiXyIsIm1lbW9pemUiLCJrZXkiLCJ2YWx1ZSIsInByb3h5Q29tbWFuZCIsIndkYSIsImRldmljZSIsImp3cFByb3h5QWN0aXZlIiwicHJveHlSZXFSZXMiLCJqd3BQcm94eUF2b2lkIiwic2FmYXJpIiwiY2FjaGVkV2RhU3RhdHVzIiwiY3VyV2ViRnJhbWVzIiwid2ViRWxlbWVudElkcyIsIl9jdXJyZW50VXJsIiwiY3VyQ29udGV4dCIsInhjb2RlVmVyc2lvbiIsImNvbnRleHRzIiwiaW1wbGljaXRXYWl0TXMiLCJhc3luY2xpYldhaXRNcyIsInBhZ2VMb2FkTXMiLCJsYW5kc2NhcGVXZWJDb29yZHNPZmZzZXQiLCJkcml2ZXJEYXRhIiwiZ2V0U3RhdHVzIiwiZHJpdmVySW5mbyIsInN0YXR1cyIsImJ1aWxkIiwidmVyc2lvbiIsImNyZWF0ZVNlc3Npb24iLCJhcmdzIiwibGlmZWN5Y2xlRGF0YSIsInNlc3Npb25JZCIsImNhcHMiLCJzdGFydCIsIk9iamVjdCIsImFzc2lnbiIsImRlZmF1bHRTZXJ2ZXJDYXBzIiwidWRpZCIsImhhcyIsInVwZGF0ZVNldHRpbmdzIiwid2RhU2V0dGluZ3MiLCJsb2ciLCJpbmZvIiwibWpwZWdTY3JlZW5zaG90VXJsIiwibWpwZWdTdHJlYW0iLCJtanBlZyIsIk1KcGVnU3RyZWFtIiwiZSIsImVycm9yIiwiZGVsZXRlU2Vzc2lvbiIsIm5vUmVzZXQiLCJmdWxsUmVzZXQiLCJpb3NTZGtWZXJzaW9uIiwicmVhbERldmljZSIsImRldGVybWluZURldmljZSIsIm5vcm1hbGl6ZWRWZXJzaW9uIiwicGxhdGZvcm1WZXJzaW9uIiwidXRpbCIsImNvbXBhcmVWZXJzaW9ucyIsIkVycm9yIiwiaXNFbXB0eSIsIndlYkRyaXZlckFnZW50VXJsIiwibG9nRXZlbnQiLCJlbmFibGVBc3luY0V4ZWN1dGVGcm9tSHR0cHMiLCJpc1JlYWxEZXZpY2UiLCJzdGFydEh0dHBzQXN5bmNTZXJ2ZXIiLCJpc0Z1bmN0aW9uIiwiZ2V0UGxhdGZvcm1WZXJzaW9uIiwiYnJvd3Nlck5hbWUiLCJ0b0xvd2VyQ2FzZSIsImFwcCIsInVuZGVmaW5lZCIsInByb2Nlc3NBcmd1bWVudHMiLCJidW5kbGVJZCIsInNhZmFyaUluaXRpYWxVcmwiLCJhZGRyZXNzIiwicG9ydCIsImNvbmZpZ3VyZUFwcCIsImFwcFV0aWxzIiwiZXh0cmFjdEJ1bmRsZUlkIiwicnVuUmVzZXQiLCJtZW1vaXplZExvZ0luZm8iLCJsb2dJbmZvIiwic3RhcnRMb2dDYXB0dXJlIiwic2tpcExvZ0NhcHR1cmUiLCJyZXN1bHQiLCJpc0xvZ0NhcHR1cmVTdGFydGVkIiwiaXNTaW11bGF0b3IiLCJzaHV0ZG93bk90aGVyU2ltdWxhdG9ycyIsImVuc3VyZUZlYXR1cmVFbmFibGVkIiwiaGFzVmFsdWUiLCJyZWR1Y2VNb3Rpb24iLCJzZXRSZWR1Y2VNb3Rpb24iLCJsb2NhbENvbmZpZyIsImlvc1NldHRpbmdzIiwic2V0TG9jYWxlQW5kUHJlZmVyZW5jZXMiLCJpc1NhZmFyaSIsInNpbSIsInN0YXJ0U2ltIiwiY3VzdG9tU1NMQ2VydCIsInRydW5jYXRlIiwibGVuZ3RoIiwiaWRiIiwiSURCIiwiY29ubmVjdCIsIm1lc3NhZ2UiLCJpbnN0YWxsQVVUIiwiaXNBcHBJbnN0YWxsZWQiLCJlcnJvckFuZFRocm93IiwicGVybWlzc2lvbnMiLCJkZWJ1ZyIsInBlcm1pc3Npb25zTWFwcGluZyIsInRvUGFpcnMiLCJKU09OIiwicGFyc2UiLCJzZXRQZXJtaXNzaW9ucyIsIndhcm4iLCJzdGFydFdkYSIsInNldEluaXRpYWxPcmllbnRhdGlvbiIsIm9yaWVudGF0aW9uIiwic3RhcnRJV0RQIiwiaXdkcFNlcnZlciIsImVuZHBvaW50IiwiZXJyIiwiYXV0b1dlYnZpZXciLCJuYXZUb0luaXRpYWxXZWJ2aWV3Iiwic2V0VXJsIiwiY2FsZW5kYXJBY2Nlc3NBdXRob3JpemVkIiwiZW5hYmxlQ2FsZW5kYXJBY2Nlc3MiLCJkaXNhYmxlQ2FsZW5kYXJBY2Nlc3MiLCJXZWJEcml2ZXJBZ2VudCIsImNsZWFudXBPYnNvbGV0ZVByb2Nlc3NlcyIsInN5bmNocm9uaXphdGlvbktleSIsInVzZVhjdGVzdHJ1bkZpbGUiLCJpc1NvdXJjZUZyZXNoIiwibmFtZSIsInBhdGgiLCJub3JtYWxpemUiLCJyZXRyaWV2ZURlcml2ZWREYXRhUGF0aCIsImlzQnVzeSIsImRlcml2ZWREYXRhUGF0aCIsImJvb3RzdHJhcFBhdGgiLCJhY3F1aXJlIiwidXNlTmV3V0RBIiwicXVpdEFuZFVuaW5zdGFsbCIsInNldHVwQ2FjaGluZyIsInVwZGF0ZWRXREFCdW5kbGVJZCIsIm1zZyIsInN0YXJ0dXBSZXRyaWVzIiwid2RhU3RhcnR1cFJldHJpZXMiLCJzdGFydHVwUmV0cnlJbnRlcnZhbCIsIndkYVN0YXJ0dXBSZXRyeUludGVydmFsIiwicmV0cnlDb3VudCIsInJldHJpZXMiLCJtYWpvciIsImxhdW5jaCIsImVycm9yTXNnIiwib3JpZ2luYWxTdGFja3RyYWNlIiwic3RhcnRXZGFTZXNzaW9uIiwic3RhY2siLCJjbGVhclN5c3RlbUZpbGVzIiwiZnVsbHlTdGFydGVkIiwic2VydmVyIiwiZGlzY29ubmVjdCIsInN0b3AiLCJpc0FwcFRlbXBvcmFyeSIsImZzIiwicmltcmFmIiwiaXNXZWJDb250ZXh0Iiwic3RvcFJlbW90ZSIsInJlc2V0T25TZXNzaW9uU3RhcnRPbmx5IiwiZW5mb3JjZVNpbXVsYXRvclNodXRkb3duIiwiY3JlYXRlU2ltIiwiZGVsZXRlIiwic3lzbG9nIiwic3RvcENhcHR1cmUiLCJzdG9wSVdEUCIsInN0b3BIdHRwc0FzeW5jU2VydmVyIiwiandwcm94eSIsInF1aXQiLCJleGVjdXRlQ29tbWFuZCIsImNtZCIsInJlY2VpdmVBc3luY1Jlc3BvbnNlIiwiYXBwSXNQYWNrYWdlT3JCdW5kbGUiLCJ0ZXN0Iiwib3JpZ2luYWxBcHBQYXRoIiwiaGVscGVycyIsImV4aXN0cyIsImlzU2FtZURlc3RpbmF0aW9uIiwiZGV2aWNlTmFtZSIsInNldHVwVmVyc2lvbkNhcHMiLCJkZXZpY2VQbGF0Zm9ybSIsImRldmljZXMiLCJqb2luIiwiaW5jbHVkZXMiLCJvc1ZlcnNpb24iLCJjb2VyY2VWZXJzaW9uIiwiZW5mb3JjZUZyZXNoU2ltdWxhdG9yQ3JlYXRpb24iLCJydW5PcHRzIiwic2NhbGVGYWN0b3IiLCJjb25uZWN0SGFyZHdhcmVLZXlib2FyZCIsImlzSGVhZGxlc3MiLCJkZXZpY2VQcmVmZXJlbmNlcyIsIlNpbXVsYXRvcldpbmRvd0NlbnRlciIsImlzU3RyaW5nIiwidG9VcHBlckNhc2UiLCJTaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbiIsIlNpbXVsYXRvcldpbmRvd1JvdGF0aW9uQW5nbGUiLCJydW4iLCJwbGF0Zm9ybU5hbWUiLCJQTEFURk9STV9OQU1FX1RWT1MiLCJQTEFURk9STV9OQU1FX0lPUyIsImxhdW5jaEFwcCIsIkFQUF9MQVVOQ0hfVElNRU9VVCIsImNoZWNrU3RhdHVzIiwicmVzcG9uc2UiLCJjdXJyZW50QXBwIiwiYnVuZGxlSUQiLCJwYXJzZUludCIsImlzQXJyYXkiLCJzdHJpbmdpZnkiLCJlbnYiLCJpc1BsYWluT2JqZWN0Iiwic2hvdWxkV2FpdEZvclF1aWVzY2VuY2UiLCJ3YWl0Rm9yUXVpZXNjZW5jZSIsIm1heFR5cGluZ0ZyZXF1ZW5jeSIsInNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyIiwic2hvdWxkVXNlVGVzdE1hbmFnZXJGb3JWaXNpYmlsaXR5RGV0ZWN0aW9uIiwiZXZlbnRsb29wSWRsZURlbGF5U2VjIiwid2RhRXZlbnRsb29wSWRsZURlbGF5Iiwic2ltcGxlSXNWaXNpYmxlQ2hlY2siLCJsYW5ndWFnZSIsInB1c2giLCJsb2NhbGUiLCJkZXNpcmVkIiwiZGVzaXJlZENhcGFiaWxpdGllcyIsImFyZ3VtZW50cyIsImVudmlyb25tZW50IiwiZWxlbWVudFJlc3BvbnNlRmllbGRzIiwiYXV0b0FjY2VwdEFsZXJ0cyIsImRlZmF1bHRBbGVydEFjdGlvbiIsImF1dG9EaXNtaXNzQWxlcnRzIiwicHJveHlBY3RpdmUiLCJnZXRQcm94eUF2b2lkTGlzdCIsImlzV2VidmlldyIsImNhblByb3h5IiwidmFsaWRhdGVMb2NhdG9yU3RyYXRlZ3kiLCJzdHJhdGVneSIsInZhbGlkYXRlRGVzaXJlZENhcHMiLCJ2ZXJpZnlQcm9jZXNzQXJndW1lbnQiLCJpc05pbCIsImtleWNoYWluUGF0aCIsImtleWNoYWluUGFzc3dvcmQiLCJjb21tYW5kVGltZW91dHMiLCJwcm90b2NvbCIsImhvc3QiLCJ1cmwiLCJwZXJtcyIsImF1dG9MYXVuY2giLCJvdGhlckFwcHMiLCJpbnN0YWxsT3RoZXJBcHBzIiwiaW9zSW5zdGFsbFBhdXNlIiwicGF1c2UiLCJCIiwiZGVsYXkiLCJwYXJzZUNhcHNBcnJheSIsIm90aGVyQXBwIiwiY3VyT3JpZW50YXRpb24iLCJfZ2V0Q29tbWFuZFRpbWVvdXQiLCJjbWROYW1lIiwiREVGQVVMVF9USU1FT1VUX0tFWSIsImdldFNlc3Npb24iLCJkcml2ZXJTZXNzaW9uIiwid2RhQ2FwcyIsImRldmljZUNhcHMiLCJzdGF0dXNCYXJTaXplIiwic2NhbGUiLCJnZXRTY3JlZW5JbmZvIiwicGl4ZWxSYXRpbyIsInN0YXRCYXJIZWlnaHQiLCJoZWlnaHQiLCJ2aWV3cG9ydFJlY3QiLCJnZXRWaWV3cG9ydFJlY3QiLCJjYXBhYmlsaXRpZXMiLCJJV0RQIiwid2Via2l0RGVidWdQcm94eVBvcnQiLCJsb2dTdGRvdXQiLCJzaG93SVdEUExvZyIsInJlc2V0IiwiY2xvbmVEZWVwIiwic2h1dGRvd25IYW5kbGVyIiwicmVzZXRPblVuZXhwZWN0ZWRTaHV0ZG93biIsInByb3RvdHlwZSIsImNvbW1hbmRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQU9BOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLHdCQUF3QixHQUFHLHFCQUFqQztBQUNBLE1BQU1DLGdCQUFnQixHQUFHLHdCQUF6QjtBQUNBLE1BQU1DLHVCQUF1QixHQUFHLENBQWhDO0FBQ0EsTUFBTUMsNEJBQTRCLEdBQUcsQ0FBckM7QUFDQSxNQUFNQyx5QkFBeUIsR0FBRyx5RkFBbEM7QUFDQSxNQUFNQywwQkFBMEIsR0FBRyxLQUFuQztBQUNBLE1BQU1DLGdCQUFnQixHQUFHO0FBQ3ZCQyxFQUFBQSxZQUFZLEVBQUUsS0FEUztBQUV2QkMsRUFBQUEsYUFBYSxFQUFFLEtBRlE7QUFHdkJD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RUFBd0NDLGNBQXhDO2VBRWVwVCxjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQmFzZURyaXZlciwgRGV2aWNlU2V0dGluZ3MgfSBmcm9tICdhcHBpdW0tYmFzZS1kcml2ZXInO1xuaW1wb3J0IHsgdXRpbCwgZnMsIG1qcGVnIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB1cmwgZnJvbSAndXJsJztcbmltcG9ydCB7IGxhdW5jaCwgb3BlblVybCB9IGZyb20gJ25vZGUtc2ltY3RsJztcbmltcG9ydCBXZWJEcml2ZXJBZ2VudCBmcm9tICcuL3dkYS93ZWJkcml2ZXJhZ2VudCc7XG5pbXBvcnQgbG9nIGZyb20gJy4vbG9nZ2VyJztcbmltcG9ydCB7XG4gIGNyZWF0ZVNpbSwgZ2V0RXhpc3RpbmdTaW0sIHJ1blNpbXVsYXRvclJlc2V0LCBpbnN0YWxsVG9TaW11bGF0b3IsXG4gIHNodXRkb3duT3RoZXJTaW11bGF0b3JzLCBzaHV0ZG93blNpbXVsYXRvciB9IGZyb20gJy4vc2ltdWxhdG9yLW1hbmFnZW1lbnQnO1xuaW1wb3J0IHsgc2ltRXhpc3RzLCBnZXRTaW11bGF0b3IsIGluc3RhbGxTU0xDZXJ0LCBoYXNTU0xDZXJ0IH0gZnJvbSAnYXBwaXVtLWlvcy1zaW11bGF0b3InO1xuaW1wb3J0IHsgcmV0cnlJbnRlcnZhbCwgcmV0cnkgfSBmcm9tICdhc3luY2JveCc7XG5pbXBvcnQgeyBzZXR0aW5ncyBhcyBpb3NTZXR0aW5ncywgZGVmYXVsdFNlcnZlckNhcHMsIGFwcFV0aWxzLCBJV0RQIH0gZnJvbSAnYXBwaXVtLWlvcy1kcml2ZXInO1xuaW1wb3J0IHsgZGVzaXJlZENhcENvbnN0cmFpbnRzLCBQTEFURk9STV9OQU1FX0lPUywgUExBVEZPUk1fTkFNRV9UVk9TIH0gZnJvbSAnLi9kZXNpcmVkLWNhcHMnO1xuaW1wb3J0IGNvbW1hbmRzIGZyb20gJy4vY29tbWFuZHMvaW5kZXgnO1xuaW1wb3J0IHtcbiAgZGV0ZWN0VWRpZCwgZ2V0QW5kQ2hlY2tYY29kZVZlcnNpb24sIGdldEFuZENoZWNrSW9zU2RrVmVyc2lvbixcbiAgY2hlY2tBcHBQcmVzZW50LCBnZXREcml2ZXJJbmZvLFxuICBjbGVhclN5c3RlbUZpbGVzLCB0cmFuc2xhdGVEZXZpY2VOYW1lLCBub3JtYWxpemVDb21tYW5kVGltZW91dHMsXG4gIERFRkFVTFRfVElNRU9VVF9LRVksIG1hcmtTeXN0ZW1GaWxlc0ZvckNsZWFudXAsXG4gIHByaW50VXNlciwgcmVtb3ZlQWxsU2Vzc2lvbldlYlNvY2tldEhhbmRsZXJzLCB2ZXJpZnlBcHBsaWNhdGlvblBsYXRmb3JtLCBpc1R2T1MsXG4gIG5vcm1hbGl6ZVBsYXRmb3JtVmVyc2lvbiB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtcbiAgZ2V0Q29ubmVjdGVkRGV2aWNlcywgcnVuUmVhbERldmljZVJlc2V0LCBpbnN0YWxsVG9SZWFsRGV2aWNlLFxuICBnZXRSZWFsRGV2aWNlT2JqLCBnZXRPU1ZlcnNpb24gfSBmcm9tICcuL3JlYWwtZGV2aWNlLW1hbmFnZW1lbnQnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IEFzeW5jTG9jayBmcm9tICdhc3luYy1sb2NrJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IElEQiBmcm9tICdhcHBpdW0taWRiJztcblxuXG5jb25zdCBTSFVURE9XTl9PVEhFUl9GRUFUX05BTUUgPSAnc2h1dGRvd25fb3RoZXJfc2ltcyc7XG5jb25zdCBTQUZBUklfQlVORExFX0lEID0gJ2NvbS5hcHBsZS5tb2JpbGVzYWZhcmknO1xuY29uc3QgV0RBX1NJTV9TVEFSVFVQX1JFVFJJRVMgPSAyO1xuY29uc3QgV0RBX1JFQUxfREVWX1NUQVJUVVBfUkVUUklFUyA9IDE7XG5jb25zdCBXREFfUkVBTF9ERVZfVFVUT1JJQUxfVVJMID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtLXhjdWl0ZXN0LWRyaXZlci9ibG9iL21hc3Rlci9kb2NzL3JlYWwtZGV2aWNlLWNvbmZpZy5tZCc7XG5jb25zdCBXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTCA9IDEwMDAwO1xuY29uc3QgREVGQVVMVF9TRVRUSU5HUyA9IHtcbiAgbmF0aXZlV2ViVGFwOiBmYWxzZSxcbiAgdXNlSlNPTlNvdXJjZTogZmFsc2UsXG4gIHNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXM6IHRydWUsXG4gIGVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXM6ICd0eXBlLGxhYmVsJyxcbiAgLy8gUmVhZCBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL1dlYkRyaXZlckFnZW50L2Jsb2IvbWFzdGVyL1dlYkRyaXZlckFnZW50TGliL1V0aWxpdGllcy9GQkNvbmZpZ3VyYXRpb24ubSBmb3IgZm9sbG93aW5nIHNldHRpbmdzJyB2YWx1ZXNcbiAgbWpwZWdTZXJ2ZXJTY3JlZW5zaG90UXVhbGl0eTogMjUsXG4gIG1qcGVnU2VydmVyRnJhbWVyYXRlOiAxMCxcbiAgc2NyZWVuc2hvdFF1YWxpdHk6IDEsXG4gIG1qcGVnU2NhbGluZ0ZhY3RvcjogMTAwLFxufTtcbi8vIFRoaXMgbG9jayBhc3N1cmVzLCB0aGF0IGVhY2ggZHJpdmVyIHNlc3Npb24gZG9lcyBub3Rcbi8vIGFmZmVjdCBzaGFyZWQgcmVzb3VyY2VzIG9mIHRoZSBvdGhlciBwYXJhbGxlbCBzZXNzaW9uc1xuY29uc3QgU0hBUkVEX1JFU09VUkNFU19HVUFSRCA9IG5ldyBBc3luY0xvY2soKTtcblxuLyogZXNsaW50LWRpc2FibGUgbm8tdXNlbGVzcy1lc2NhcGUgKi9cbmNvbnN0IE5PX1BST1hZX05BVElWRV9MSVNUID0gW1xuICBbJ0RFTEVURScsIC93aW5kb3cvXSxcbiAgWydHRVQnLCAvXlxcL3Nlc3Npb25cXC9bXlxcL10rJC9dLFxuICBbJ0dFVCcsIC9hbGVydF90ZXh0L10sXG4gIFsnR0VUJywgL2FsZXJ0XFwvW15cXC9dKy9dLFxuICBbJ0dFVCcsIC9hcHBpdW0vXSxcbiAgWydHRVQnLCAvYXR0cmlidXRlL10sXG4gIFsnR0VUJywgL2NvbnRleHQvXSxcbiAgWydHRVQnLCAvbG9jYXRpb24vXSxcbiAgWydHRVQnLCAvbG9nL10sXG4gIFsnR0VUJywgL3NjcmVlbnNob3QvXSxcbiAgWydHRVQnLCAvc2l6ZS9dLFxuICBbJ0dFVCcsIC9zb3VyY2UvXSxcbiAgWydHRVQnLCAvdXJsL10sXG4gIFsnR0VUJywgL3dpbmRvdy9dLFxuICBbJ1BPU1QnLCAvYWNjZXB0X2FsZXJ0L10sXG4gIFsnUE9TVCcsIC9hY3Rpb25zJC9dLFxuICBbJ1BPU1QnLCAvYWxlcnRfdGV4dC9dLFxuICBbJ1BPU1QnLCAvYWxlcnRcXC9bXlxcL10rL10sXG4gIFsnUE9TVCcsIC9hcHBpdW0vXSxcbiAgWydQT1NUJywgL2FwcGl1bVxcL2RldmljZVxcL2lzX2xvY2tlZC9dLFxuICBbJ1BPU1QnLCAvYXBwaXVtXFwvZGV2aWNlXFwvbG9jay9dLFxuICBbJ1BPU1QnLCAvYXBwaXVtXFwvZGV2aWNlXFwvdW5sb2NrL10sXG4gIFsnUE9TVCcsIC9iYWNrL10sXG4gIFsnUE9TVCcsIC9jbGVhci9dLFxuICBbJ1BPU1QnLCAvY29udGV4dC9dLFxuICBbJ1BPU1QnLCAvZGlzbWlzc19hbGVydC9dLFxuICBbJ1BPU1QnLCAvZWxlbWVudFxcL2FjdGl2ZS9dLCAvLyBNSlNPTldQIGdldCBhY3RpdmUgZWxlbWVudCBzaG91bGQgcHJveHlcbiAgWydQT1NUJywgL2VsZW1lbnQkL10sXG4gIFsnUE9TVCcsIC9lbGVtZW50cyQvXSxcbiAgWydQT1NUJywgL2V4ZWN1dGUvXSxcbiAgWydQT1NUJywgL2tleXMvXSxcbiAgWydQT1NUJywgL2xvZy9dLFxuICBbJ1BPU1QnLCAvbW92ZXRvL10sXG4gIFsnUE9TVCcsIC9yZWNlaXZlX2FzeW5jX3Jlc3BvbnNlL10sIC8vIGFsd2F5cywgaW4gY2FzZSBjb250ZXh0IHN3aXRjaGVzIHdoaWxlIHdhaXRpbmdcbiAgWydQT1NUJywgL3Nlc3Npb25cXC9bXlxcL10rXFwvbG9jYXRpb24vXSwgLy8gZ2VvIGxvY2F0aW9uLCBidXQgbm90IGVsZW1lbnQgbG9jYXRpb25cbiAgWydQT1NUJywgL3NoYWtlL10sXG4gIFsnUE9TVCcsIC90aW1lb3V0cy9dLFxuICBbJ1BPU1QnLCAvdG91Y2gvXSxcbiAgWydQT1NUJywgL3VybC9dLFxuICBbJ1BPU1QnLCAvdmFsdWUvXSxcbiAgWydQT1NUJywgL3dpbmRvdy9dLFxuXTtcbmNvbnN0IE5PX1BST1hZX1dFQl9MSVNUID0gW1xuICBbJ0RFTEVURScsIC9jb29raWUvXSxcbiAgWydHRVQnLCAvYXR0cmlidXRlL10sXG4gIFsnR0VUJywgL2Nvb2tpZS9dLFxuICBbJ0dFVCcsIC9lbGVtZW50L10sXG4gIFsnR0VUJywgL3RleHQvXSxcbiAgWydHRVQnLCAvdGl0bGUvXSxcbiAgWydQT1NUJywgL2NsZWFyL10sXG4gIFsnUE9TVCcsIC9jbGljay9dLFxuICBbJ1BPU1QnLCAvY29va2llL10sXG4gIFsnUE9TVCcsIC9lbGVtZW50L10sXG4gIFsnUE9TVCcsIC9mb3J3YXJkL10sXG4gIFsnUE9TVCcsIC9mcmFtZS9dLFxuICBbJ1BPU1QnLCAva2V5cy9dLFxuICBbJ1BPU1QnLCAvcmVmcmVzaC9dLFxuXS5jb25jYXQoTk9fUFJPWFlfTkFUSVZFX0xJU1QpO1xuLyogZXNsaW50LWVuYWJsZSBuby11c2VsZXNzLWVzY2FwZSAqL1xuXG5jb25zdCBNRU1PSVpFRF9GVU5DVElPTlMgPSBbXG4gICdnZXRTdGF0dXNCYXJIZWlnaHQnLFxuICAnZ2V0RGV2aWNlUGl4ZWxSYXRpbycsXG4gICdnZXRTY3JlZW5JbmZvJyxcbiAgJ2dldFNhZmFyaUlzSXBob25lJyxcbiAgJ2dldFNhZmFyaUlzSXBob25lWCcsXG5dO1xuXG5jbGFzcyBYQ1VJVGVzdERyaXZlciBleHRlbmRzIEJhc2VEcml2ZXIge1xuICBjb25zdHJ1Y3RvciAob3B0cyA9IHt9LCBzaG91bGRWYWxpZGF0ZUNhcHMgPSB0cnVlKSB7XG4gICAgc3VwZXIob3B0cywgc2hvdWxkVmFsaWRhdGVDYXBzKTtcblxuICAgIHRoaXMuZGVzaXJlZENhcENvbnN0cmFpbnRzID0gZGVzaXJlZENhcENvbnN0cmFpbnRzO1xuXG4gICAgdGhpcy5sb2NhdG9yU3RyYXRlZ2llcyA9IFtcbiAgICAgICd4cGF0aCcsXG4gICAgICAnaWQnLFxuICAgICAgJ25hbWUnLFxuICAgICAgJ2NsYXNzIG5hbWUnLFxuICAgICAgJy1pb3MgcHJlZGljYXRlIHN0cmluZycsXG4gICAgICAnLWlvcyBjbGFzcyBjaGFpbicsXG4gICAgICAnYWNjZXNzaWJpbGl0eSBpZCdcbiAgICBdO1xuICAgIHRoaXMud2ViTG9jYXRvclN0cmF0ZWdpZXMgPSBbXG4gICAgICAnbGluayB0ZXh0JyxcbiAgICAgICdjc3Mgc2VsZWN0b3InLFxuICAgICAgJ3RhZyBuYW1lJyxcbiAgICAgICdsaW5rIHRleHQnLFxuICAgICAgJ3BhcnRpYWwgbGluayB0ZXh0J1xuICAgIF07XG4gICAgdGhpcy5yZXNldElvcygpO1xuICAgIHRoaXMuc2V0dGluZ3MgPSBuZXcgRGV2aWNlU2V0dGluZ3MoREVGQVVMVF9TRVRUSU5HUywgdGhpcy5vblNldHRpbmdzVXBkYXRlLmJpbmQodGhpcykpO1xuICAgIHRoaXMubG9ncyA9IHt9O1xuXG4gICAgLy8gbWVtb2l6ZSBmdW5jdGlvbnMgaGVyZSwgc28gdGhhdCB0aGV5IGFyZSBkb25lIG9uIGEgcGVyLWluc3RhbmNlIGJhc2lzXG4gICAgZm9yIChjb25zdCBmbiBvZiBNRU1PSVpFRF9GVU5DVElPTlMpIHtcbiAgICAgIHRoaXNbZm5dID0gXy5tZW1vaXplKHRoaXNbZm5dKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBvblNldHRpbmdzVXBkYXRlIChrZXksIHZhbHVlKSB7XG4gICAgaWYgKGtleSAhPT0gJ25hdGl2ZVdlYlRhcCcpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZCgnL2FwcGl1bS9zZXR0aW5ncycsICdQT1NUJywge1xuICAgICAgICBzZXR0aW5nczoge1trZXldOiB2YWx1ZX1cbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLm9wdHMubmF0aXZlV2ViVGFwID0gISF2YWx1ZTtcbiAgfVxuXG4gIHJlc2V0SW9zICgpIHtcbiAgICB0aGlzLm9wdHMgPSB0aGlzLm9wdHMgfHwge307XG4gICAgdGhpcy53ZGEgPSBudWxsO1xuICAgIHRoaXMub3B0cy5kZXZpY2UgPSBudWxsO1xuICAgIHRoaXMuandwUHJveHlBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLnByb3h5UmVxUmVzID0gbnVsbDtcbiAgICB0aGlzLmp3cFByb3h5QXZvaWQgPSBbXTtcbiAgICB0aGlzLnNhZmFyaSA9IGZhbHNlO1xuICAgIHRoaXMuY2FjaGVkV2RhU3RhdHVzID0gbnVsbDtcblxuICAgIC8vIHNvbWUgdGhpbmdzIHRoYXQgY29tbWFuZHMgaW1wb3J0ZWQgZnJvbSBhcHBpdW0taW9zLWRyaXZlciBuZWVkXG4gICAgdGhpcy5jdXJXZWJGcmFtZXMgPSBbXTtcbiAgICB0aGlzLndlYkVsZW1lbnRJZHMgPSBbXTtcbiAgICB0aGlzLl9jdXJyZW50VXJsID0gbnVsbDtcbiAgICB0aGlzLmN1ckNvbnRleHQgPSBudWxsO1xuICAgIHRoaXMueGNvZGVWZXJzaW9uID0ge307XG4gICAgdGhpcy5jb250ZXh0cyA9IFtdO1xuICAgIHRoaXMuaW1wbGljaXRXYWl0TXMgPSAwO1xuICAgIHRoaXMuYXN5bmNsaWJXYWl0TXMgPSAwO1xuICAgIHRoaXMucGFnZUxvYWRNcyA9IDYwMDA7XG4gICAgdGhpcy5sYW5kc2NhcGVXZWJDb29yZHNPZmZzZXQgPSAwO1xuICB9XG5cbiAgZ2V0IGRyaXZlckRhdGEgKCkge1xuICAgIC8vIFRPRE8gZmlsbCBvdXQgcmVzb3VyY2UgaW5mbyBoZXJlXG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgYXN5bmMgZ2V0U3RhdHVzICgpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMuZHJpdmVySW5mbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRoaXMuZHJpdmVySW5mbyA9IGF3YWl0IGdldERyaXZlckluZm8oKTtcbiAgICB9XG4gICAgbGV0IHN0YXR1cyA9IHtidWlsZDoge3ZlcnNpb246IHRoaXMuZHJpdmVySW5mby52ZXJzaW9ufX07XG4gICAgaWYgKHRoaXMuY2FjaGVkV2RhU3RhdHVzKSB7XG4gICAgICBzdGF0dXMud2RhID0gdGhpcy5jYWNoZWRXZGFTdGF0dXM7XG4gICAgfVxuICAgIHJldHVybiBzdGF0dXM7XG4gIH1cblxuICBhc3luYyBjcmVhdGVTZXNzaW9uICguLi5hcmdzKSB7XG4gICAgdGhpcy5saWZlY3ljbGVEYXRhID0ge307IC8vIHRoaXMgaXMgdXNlZCBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgc3RhdGUgd2Ugc3RhcnQgc28gd2hlbiB3ZSBkZWxldGUgdGhlIHNlc3Npb24gd2UgY2FuIHB1dCB0aGluZ3MgYmFja1xuICAgIHRyeSB7XG4gICAgICAvLyBUT0RPIGFkZCB2YWxpZGF0aW9uIG9uIGNhcHNcbiAgICAgIGxldCBbc2Vzc2lvbklkLCBjYXBzXSA9IGF3YWl0IHN1cGVyLmNyZWF0ZVNlc3Npb24oLi4uYXJncyk7XG4gICAgICB0aGlzLm9wdHMuc2Vzc2lvbklkID0gc2Vzc2lvbklkO1xuXG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0KCk7XG5cbiAgICAgIC8vIG1lcmdlIHNlcnZlciBjYXBhYmlsaXRpZXMgKyBkZXNpcmVkIGNhcGFiaWxpdGllc1xuICAgICAgY2FwcyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRTZXJ2ZXJDYXBzLCBjYXBzKTtcbiAgICAgIC8vIHVwZGF0ZSB0aGUgdWRpZCB3aXRoIHdoYXQgaXMgYWN0dWFsbHkgdXNlZFxuICAgICAgY2Fwcy51ZGlkID0gdGhpcy5vcHRzLnVkaWQ7XG4gICAgICAvLyBlbnN1cmUgd2UgdHJhY2sgbmF0aXZlV2ViVGFwIGNhcGFiaWxpdHkgYXMgYSBzZXR0aW5nIGFzIHdlbGxcbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICduYXRpdmVXZWJUYXAnKSkge1xuICAgICAgICBhd2FpdCB0aGlzLnVwZGF0ZVNldHRpbmdzKHtuYXRpdmVXZWJUYXA6IHRoaXMub3B0cy5uYXRpdmVXZWJUYXB9KTtcbiAgICAgIH1cbiAgICAgIC8vIGVuc3VyZSB3ZSB0cmFjayB1c2VKU09OU291cmNlIGNhcGFiaWxpdHkgYXMgYSBzZXR0aW5nIGFzIHdlbGxcbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICd1c2VKU09OU291cmNlJykpIHtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXR0aW5ncyh7dXNlSlNPTlNvdXJjZTogdGhpcy5vcHRzLnVzZUpTT05Tb3VyY2V9KTtcbiAgICAgIH1cblxuICAgICAgbGV0IHdkYVNldHRpbmdzID0ge1xuICAgICAgICBlbGVtZW50UmVzcG9uc2VBdHRyaWJ1dGVzOiBERUZBVUxUX1NFVFRJTkdTLmVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMsXG4gICAgICAgIHNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXM6IERFRkFVTFRfU0VUVElOR1Muc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyxcbiAgICAgIH07XG4gICAgICBpZiAoXy5oYXModGhpcy5vcHRzLCAnZWxlbWVudFJlc3BvbnNlQXR0cmlidXRlcycpKSB7XG4gICAgICAgIHdkYVNldHRpbmdzLmVsZW1lbnRSZXNwb25zZUF0dHJpYnV0ZXMgPSB0aGlzLm9wdHMuZWxlbWVudFJlc3BvbnNlQXR0cmlidXRlcztcbiAgICAgIH1cbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICdzaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzJykpIHtcbiAgICAgICAgd2RhU2V0dGluZ3Muc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyA9IHRoaXMub3B0cy5zaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzO1xuICAgICAgfVxuICAgICAgaWYgKF8uaGFzKHRoaXMub3B0cywgJ21qcGVnU2VydmVyU2NyZWVuc2hvdFF1YWxpdHknKSkge1xuICAgICAgICB3ZGFTZXR0aW5ncy5tanBlZ1NlcnZlclNjcmVlbnNob3RRdWFsaXR5ID0gdGhpcy5vcHRzLm1qcGVnU2VydmVyU2NyZWVuc2hvdFF1YWxpdHk7XG4gICAgICB9XG4gICAgICBpZiAoXy5oYXModGhpcy5vcHRzLCAnbWpwZWdTZXJ2ZXJGcmFtZXJhdGUnKSkge1xuICAgICAgICB3ZGFTZXR0aW5ncy5tanBlZ1NlcnZlckZyYW1lcmF0ZSA9IHRoaXMub3B0cy5tanBlZ1NlcnZlckZyYW1lcmF0ZTtcbiAgICAgIH1cbiAgICAgIGlmIChfLmhhcyh0aGlzLm9wdHMsICdzY3JlZW5zaG90UXVhbGl0eScpKSB7XG4gICAgICAgIGxvZy5pbmZvKGBTZXR0aW5nIHRoZSBxdWFsaXR5IG9mIHBob25lIHNjcmVlbnNob3Q6ICcke3RoaXMub3B0cy5zY3JlZW5zaG90UXVhbGl0eX0nYCk7XG4gICAgICAgIHdkYVNldHRpbmdzLnNjcmVlbnNob3RRdWFsaXR5ID0gdGhpcy5vcHRzLnNjcmVlbnNob3RRdWFsaXR5O1xuICAgICAgfVxuICAgICAgLy8gZW5zdXJlIFdEQSBnZXRzIG91ciBkZWZhdWx0cyBpbnN0ZWFkIG9mIHdoYXRldmVyIGl0cyBvd24gbWlnaHQgYmVcbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2V0dGluZ3Mod2RhU2V0dGluZ3MpO1xuXG4gICAgICAvLyB0dXJuIG9uIG1qcGVnIHN0cmVhbSByZWFkaW5nIGlmIHJlcXVlc3RlZFxuICAgICAgaWYgKHRoaXMub3B0cy5tanBlZ1NjcmVlbnNob3RVcmwpIHtcbiAgICAgICAgbG9nLmluZm8oYFN0YXJ0aW5nIE1KUEVHIHN0cmVhbSByZWFkaW5nIFVSTDogJyR7dGhpcy5vcHRzLm1qcGVnU2NyZWVuc2hvdFVybH0nYCk7XG4gICAgICAgIHRoaXMubWpwZWdTdHJlYW0gPSBuZXcgbWpwZWcuTUpwZWdTdHJlYW0odGhpcy5vcHRzLm1qcGVnU2NyZWVuc2hvdFVybCk7XG4gICAgICAgIGF3YWl0IHRoaXMubWpwZWdTdHJlYW0uc3RhcnQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBbc2Vzc2lvbklkLCBjYXBzXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZXJyb3IoZSk7XG4gICAgICBhd2FpdCB0aGlzLmRlbGV0ZVNlc3Npb24oKTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3RhcnQgKCkge1xuICAgIHRoaXMub3B0cy5ub1Jlc2V0ID0gISF0aGlzLm9wdHMubm9SZXNldDtcbiAgICB0aGlzLm9wdHMuZnVsbFJlc2V0ID0gISF0aGlzLm9wdHMuZnVsbFJlc2V0O1xuXG4gICAgYXdhaXQgcHJpbnRVc2VyKCk7XG5cbiAgICB0aGlzLm9wdHMuaW9zU2RrVmVyc2lvbiA9IG51bGw7IC8vIEZvciBXREEgYW5kIHhjb2RlYnVpbGRcbiAgICBjb25zdCB7ZGV2aWNlLCB1ZGlkLCByZWFsRGV2aWNlfSA9IGF3YWl0IHRoaXMuZGV0ZXJtaW5lRGV2aWNlKCk7XG4gICAgbG9nLmluZm8oYERldGVybWluaW5nIGRldmljZSB0byBydW4gdGVzdHMgb246IHVkaWQ6ICcke3VkaWR9JywgcmVhbCBkZXZpY2U6ICR7cmVhbERldmljZX1gKTtcbiAgICB0aGlzLm9wdHMuZGV2aWNlID0gZGV2aWNlO1xuICAgIHRoaXMub3B0cy51ZGlkID0gdWRpZDtcbiAgICB0aGlzLm9wdHMucmVhbERldmljZSA9IHJlYWxEZXZpY2U7XG5cbiAgICBjb25zdCBub3JtYWxpemVkVmVyc2lvbiA9IG5vcm1hbGl6ZVBsYXRmb3JtVmVyc2lvbih0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uKTtcbiAgICBpZiAodGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbiAhPT0gbm9ybWFsaXplZFZlcnNpb24pIHtcbiAgICAgIGxvZy5pbmZvKGBOb3JtYWxpemVkIHBsYXRmb3JtVmVyc2lvbiBjYXBhYmlsaXR5IHZhbHVlICcke3RoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb259JyB0byAnJHtub3JtYWxpemVkVmVyc2lvbn0nYCk7XG4gICAgICB0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uID0gbm9ybWFsaXplZFZlcnNpb247XG4gICAgfVxuICAgIGlmICh1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPCcsICc5LjMnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBQbGF0Zm9ybSB2ZXJzaW9uIG11c3QgYmUgOS4zIG9yIGFib3ZlLiAnJHt0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9ufScgaXMgbm90IHN1cHBvcnRlZC5gKTtcbiAgICB9XG5cbiAgICBpZiAoXy5pc0VtcHR5KHRoaXMueGNvZGVWZXJzaW9uKSAmJiAoIXRoaXMub3B0cy53ZWJEcml2ZXJBZ2VudFVybCB8fCAhdGhpcy5vcHRzLnJlYWxEZXZpY2UpKSB7XG4gICAgICAvLyBubyBgd2ViRHJpdmVyQWdlbnRVcmxgLCBvciBvbiBhIHNpbXVsYXRvciwgc28gd2UgbmVlZCBhbiBYY29kZSB2ZXJzaW9uXG4gICAgICB0aGlzLnhjb2RlVmVyc2lvbiA9IGF3YWl0IGdldEFuZENoZWNrWGNvZGVWZXJzaW9uKCk7XG4gICAgfVxuICAgIHRoaXMubG9nRXZlbnQoJ3hjb2RlRGV0YWlsc1JldHJpZXZlZCcpO1xuXG4gICAgaWYgKHRoaXMub3B0cy5lbmFibGVBc3luY0V4ZWN1dGVGcm9tSHR0cHMgJiYgIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIC8vIHNodXRkb3duIHRoZSBzaW11bGF0b3Igc28gdGhhdCB0aGUgc3NsIGNlcnQgaXMgcmVjb2duaXplZFxuICAgICAgYXdhaXQgc2h1dGRvd25TaW11bGF0b3IodGhpcy5vcHRzLmRldmljZSk7XG4gICAgICBhd2FpdCB0aGlzLnN0YXJ0SHR0cHNBc3luY1NlcnZlcigpO1xuICAgIH1cblxuICAgIC8vIGF0IHRoaXMgcG9pbnQgaWYgdGhlcmUgaXMgbm8gcGxhdGZvcm1WZXJzaW9uLCBnZXQgaXQgZnJvbSB0aGUgZGV2aWNlXG4gICAgaWYgKCF0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uKSB7XG4gICAgICBpZiAodGhpcy5vcHRzLmRldmljZSAmJiBfLmlzRnVuY3Rpb24odGhpcy5vcHRzLmRldmljZS5nZXRQbGF0Zm9ybVZlcnNpb24pKSB7XG4gICAgICAgIHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gPSBhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLmdldFBsYXRmb3JtVmVyc2lvbigpO1xuICAgICAgICBsb2cuaW5mbyhgTm8gcGxhdGZvcm1WZXJzaW9uIHNwZWNpZmllZC4gVXNpbmcgZGV2aWNlIHZlcnNpb246ICcke3RoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb259J2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVE9ETzogdGhpcyBpcyB3aGVuIGl0IGlzIGEgcmVhbCBkZXZpY2UuIHdoZW4gd2UgaGF2ZSBhIHJlYWwgb2JqZWN0IHdpcmUgaXQgaW5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoKHRoaXMub3B0cy5icm93c2VyTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKSA9PT0gJ3NhZmFyaScpIHtcbiAgICAgIGxvZy5pbmZvKCdTYWZhcmkgdGVzdCByZXF1ZXN0ZWQnKTtcbiAgICAgIHRoaXMuc2FmYXJpID0gdHJ1ZTtcbiAgICAgIHRoaXMub3B0cy5hcHAgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm9wdHMucHJvY2Vzc0FyZ3VtZW50cyA9IHRoaXMub3B0cy5wcm9jZXNzQXJndW1lbnRzIHx8IHt9O1xuICAgICAgdGhpcy5vcHRzLmJ1bmRsZUlkID0gU0FGQVJJX0JVTkRMRV9JRDtcbiAgICAgIHRoaXMuX2N1cnJlbnRVcmwgPSB0aGlzLm9wdHMuc2FmYXJpSW5pdGlhbFVybCB8fCAoXG4gICAgICAgIHRoaXMuaXNSZWFsRGV2aWNlKClcbiAgICAgICAgICA/ICdodHRwOi8vYXBwaXVtLmlvJ1xuICAgICAgICAgIDogYGh0dHA6Ly8ke3RoaXMub3B0cy5hZGRyZXNzfToke3RoaXMub3B0cy5wb3J0fS93ZWxjb21lYFxuICAgICAgKTtcbiAgICAgIGlmICh1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPCcsICcxMi4yJykpIHtcbiAgICAgICAgLy8gdGhpcyBvcHRpb24gZG9lcyBub3Qgd29yayBvbiAxMi4yIGFuZCBhYm92ZVxuICAgICAgICB0aGlzLm9wdHMucHJvY2Vzc0FyZ3VtZW50cy5hcmdzID0gWyctdScsIHRoaXMuX2N1cnJlbnRVcmxdO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLmNvbmZpZ3VyZUFwcCgpO1xuICAgIH1cbiAgICB0aGlzLmxvZ0V2ZW50KCdhcHBDb25maWd1cmVkJyk7XG5cbiAgICAvLyBmYWlsIHZlcnkgZWFybHkgaWYgdGhlIGFwcCBkb2Vzbid0IGFjdHVhbGx5IGV4aXN0XG4gICAgLy8gb3IgaWYgYnVuZGxlIGlkIGRvZXNuJ3QgcG9pbnQgdG8gYW4gaW5zdGFsbGVkIGFwcFxuICAgIGlmICh0aGlzLm9wdHMuYXBwKSB7XG4gICAgICBhd2FpdCBjaGVja0FwcFByZXNlbnQodGhpcy5vcHRzLmFwcCk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLm9wdHMuYnVuZGxlSWQpIHtcbiAgICAgIHRoaXMub3B0cy5idW5kbGVJZCA9IGF3YWl0IGFwcFV0aWxzLmV4dHJhY3RCdW5kbGVJZCh0aGlzLm9wdHMuYXBwKTtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnJ1blJlc2V0KCk7XG5cbiAgICBjb25zdCBtZW1vaXplZExvZ0luZm8gPSBfLm1lbW9pemUoZnVuY3Rpb24gbG9nSW5mbyAoKSB7XG4gICAgICBsb2cuaW5mbyhcIidza2lwTG9nQ2FwdHVyZScgaXMgc2V0LiBTa2lwcGluZyBzdGFydGluZyBsb2dzIHN1Y2ggYXMgY3Jhc2gsIHN5c3RlbSwgc2FmYXJpIGNvbnNvbGUgYW5kIHNhZmFyaSBuZXR3b3JrLlwiKTtcbiAgICB9KTtcbiAgICBjb25zdCBzdGFydExvZ0NhcHR1cmUgPSBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5vcHRzLnNraXBMb2dDYXB0dXJlKSB7XG4gICAgICAgIG1lbW9pemVkTG9nSW5mbygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc3RhcnRMb2dDYXB0dXJlKCk7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHRoaXMubG9nRXZlbnQoJ2xvZ0NhcHR1cmVTdGFydGVkJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgY29uc3QgaXNMb2dDYXB0dXJlU3RhcnRlZCA9IGF3YWl0IHN0YXJ0TG9nQ2FwdHVyZSgpO1xuXG4gICAgbG9nLmluZm8oYFNldHRpbmcgdXAgJHt0aGlzLmlzUmVhbERldmljZSgpID8gJ3JlYWwgZGV2aWNlJyA6ICdzaW11bGF0b3InfWApO1xuXG4gICAgaWYgKHRoaXMuaXNTaW11bGF0b3IoKSkge1xuICAgICAgaWYgKHRoaXMub3B0cy5zaHV0ZG93bk90aGVyU2ltdWxhdG9ycykge1xuICAgICAgICB0aGlzLmVuc3VyZUZlYXR1cmVFbmFibGVkKFNIVVRET1dOX09USEVSX0ZFQVRfTkFNRSk7XG4gICAgICAgIGF3YWl0IHNodXRkb3duT3RoZXJTaW11bGF0b3JzKHRoaXMub3B0cy5kZXZpY2UpO1xuICAgICAgfVxuXG4gICAgICAvLyBzZXQgcmVkdWNlTW90aW9uIGlmIGNhcGFiaWxpdHkgaXMgc2V0XG4gICAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMucmVkdWNlTW90aW9uKSkge1xuICAgICAgICBhd2FpdCB0aGlzLm9wdHMuZGV2aWNlLnNldFJlZHVjZU1vdGlvbih0aGlzLm9wdHMucmVkdWNlTW90aW9uKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2NhbENvbmZpZyA9IGF3YWl0IGlvc1NldHRpbmdzLnNldExvY2FsZUFuZFByZWZlcmVuY2VzKHRoaXMub3B0cy5kZXZpY2UsIHRoaXMub3B0cywgdGhpcy5pc1NhZmFyaSgpLCBhc3luYyAoc2ltKSA9PiB7XG4gICAgICAgIGF3YWl0IHNodXRkb3duU2ltdWxhdG9yKHNpbSk7XG5cbiAgICAgICAgLy8gd2UgZG9uJ3Qga25vdyBpZiB0aGVyZSBuZWVkcyB0byBiZSBjaGFuZ2VzIGEgcHJpb3JpLCBzbyBjaGFuZ2UgZmlyc3QuXG4gICAgICAgIC8vIHNvbWV0aW1lcyB0aGUgc2h1dGRvd24gcHJvY2VzcyBjaGFuZ2VzIHRoZSBzZXR0aW5ncywgc28gcmVzZXQgdGhlbSxcbiAgICAgICAgLy8ga25vd2luZyB0aGF0IHRoZSBzaW0gaXMgYWxyZWFkeSBzaHV0XG4gICAgICAgIGF3YWl0IGlvc1NldHRpbmdzLnNldExvY2FsZUFuZFByZWZlcmVuY2VzKHNpbSwgdGhpcy5vcHRzLCB0aGlzLmlzU2FmYXJpKCkpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHRoaXMuc3RhcnRTaW0oKTtcblxuICAgICAgaWYgKHRoaXMub3B0cy5jdXN0b21TU0xDZXJ0KSB7XG4gICAgICAgIGlmIChhd2FpdCBoYXNTU0xDZXJ0KHRoaXMub3B0cy5jdXN0b21TU0xDZXJ0LCB0aGlzLm9wdHMudWRpZCkpIHtcbiAgICAgICAgICBsb2cuaW5mbyhgU1NMIGNlcnQgJyR7Xy50cnVuY2F0ZSh0aGlzLm9wdHMuY3VzdG9tU1NMQ2VydCwge2xlbmd0aDogMjB9KX0nIGFscmVhZHkgaW5zdGFsbGVkYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9nLmluZm8oYEluc3RhbGxpbmcgc3NsIGNlcnQgJyR7Xy50cnVuY2F0ZSh0aGlzLm9wdHMuY3VzdG9tU1NMQ2VydCwge2xlbmd0aDogMjB9KX0nYCk7XG4gICAgICAgICAgYXdhaXQgc2h1dGRvd25TaW11bGF0b3IodGhpcy5vcHRzLmRldmljZSk7XG4gICAgICAgICAgYXdhaXQgaW5zdGFsbFNTTENlcnQodGhpcy5vcHRzLmN1c3RvbVNTTENlcnQsIHRoaXMub3B0cy51ZGlkKTtcbiAgICAgICAgICBsb2cuaW5mbyhgUmVzdGFydGluZyBTaW11bGF0b3Igc28gdGhhdCBTU0wgY2VydGlmaWNhdGUgaW5zdGFsbGF0aW9uIHRha2VzIGVmZmVjdGApO1xuICAgICAgICAgIGF3YWl0IHRoaXMuc3RhcnRTaW0oKTtcbiAgICAgICAgICB0aGlzLmxvZ0V2ZW50KCdjdXN0b21DZXJ0SW5zdGFsbGVkJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaWRiID0gbmV3IElEQih7dWRpZH0pO1xuICAgICAgICBhd2FpdCBpZGIuY29ubmVjdCgpO1xuICAgICAgICB0aGlzLm9wdHMuZGV2aWNlLmlkYiA9IGlkYjtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLmluZm8oYGlkYiB3aWxsIG5vdCBiZSB1c2VkIGZvciBTaW11bGF0b3IgaW50ZXJhY3Rpb24uIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5sb2dFdmVudCgnc2ltU3RhcnRlZCcpO1xuICAgICAgaWYgKCFpc0xvZ0NhcHR1cmVTdGFydGVkKSB7XG4gICAgICAgIC8vIFJldHJ5IGxvZyBjYXB0dXJlIGlmIFNpbXVsYXRvciB3YXMgbm90IHJ1bm5pbmcgYmVmb3JlXG4gICAgICAgIGF3YWl0IHN0YXJ0TG9nQ2FwdHVyZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMuYXBwKSB7XG4gICAgICBhd2FpdCB0aGlzLmluc3RhbGxBVVQoKTtcbiAgICAgIHRoaXMubG9nRXZlbnQoJ2FwcEluc3RhbGxlZCcpO1xuICAgIH1cblxuICAgIC8vIGlmIHdlIG9ubHkgaGF2ZSBidW5kbGUgaWRlbnRpZmllciBhbmQgbm8gYXBwLCBmYWlsIGlmIGl0IGlzIG5vdCBhbHJlYWR5IGluc3RhbGxlZFxuICAgIGlmICghdGhpcy5vcHRzLmFwcCAmJiB0aGlzLm9wdHMuYnVuZGxlSWQgJiYgIXRoaXMuc2FmYXJpKSB7XG4gICAgICBpZiAoIWF3YWl0IHRoaXMub3B0cy5kZXZpY2UuaXNBcHBJbnN0YWxsZWQodGhpcy5vcHRzLmJ1bmRsZUlkKSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQXBwIHdpdGggYnVuZGxlIGlkZW50aWZpZXIgJyR7dGhpcy5vcHRzLmJ1bmRsZUlkfScgdW5rbm93bmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLm9wdHMucGVybWlzc2lvbnMpIHtcbiAgICAgIGlmICh0aGlzLmlzU2ltdWxhdG9yKCkpIHtcbiAgICAgICAgbG9nLmRlYnVnKCdTZXR0aW5nIHRoZSByZXF1ZXN0ZWQgcGVybWlzc2lvbnMgYmVmb3JlIFdEQSBpcyBzdGFydGVkJyk7XG4gICAgICAgIGZvciAoY29uc3QgW2J1bmRsZUlkLCBwZXJtaXNzaW9uc01hcHBpbmddIG9mIF8udG9QYWlycyhKU09OLnBhcnNlKHRoaXMub3B0cy5wZXJtaXNzaW9ucykpKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5zZXRQZXJtaXNzaW9ucyhidW5kbGVJZCwgcGVybWlzc2lvbnNNYXBwaW5nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLndhcm4oJ1NldHRpbmcgcGVybWlzc2lvbnMgaXMgb25seSBzdXBwb3J0ZWQgb24gU2ltdWxhdG9yLiAnICtcbiAgICAgICAgICAnVGhlIFwicGVybWlzc2lvbnNcIiBjYXBhYmlsaXR5IHdpbGwgYmUgaWdub3JlZC4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnN0YXJ0V2RhKHRoaXMub3B0cy5zZXNzaW9uSWQsIHJlYWxEZXZpY2UpO1xuXG4gICAgYXdhaXQgdGhpcy5zZXRJbml0aWFsT3JpZW50YXRpb24odGhpcy5vcHRzLm9yaWVudGF0aW9uKTtcbiAgICB0aGlzLmxvZ0V2ZW50KCdvcmllbnRhdGlvblNldCcpO1xuXG4gICAgLy8gcmVhbCBkZXZpY2VzIHdpbGwgYmUgaGFuZGxlZCBsYXRlciwgYWZ0ZXIgdGhlIHdlYiBjb250ZXh0IGhhcyBiZWVuIGluaXRpYWxpemVkXG4gICAgaWYgKHRoaXMuaXNTYWZhcmkoKSAmJiAhdGhpcy5pc1JlYWxEZXZpY2UoKSAmJiB1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPj0nLCAnMTIuMicpKSB7XG4gICAgICAvLyBvbiAxMi4yIHRoZSBwYWdlIGlzIG5vdCBvcGVuZWQgaW4gV0RBXG4gICAgICBhd2FpdCBvcGVuVXJsKHRoaXMub3B0cy5kZXZpY2UudWRpZCwgdGhpcy5fY3VycmVudFVybCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNSZWFsRGV2aWNlKCkgJiYgdGhpcy5vcHRzLnN0YXJ0SVdEUCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5zdGFydElXRFAoKTtcbiAgICAgICAgbG9nLmRlYnVnKGBTdGFydGVkIGlvc193ZWJraXRfZGVidWcgcHJveHkgc2VydmVyIGF0OiAke3RoaXMuaXdkcFNlcnZlci5lbmRwb2ludH1gKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQ291bGQgbm90IHN0YXJ0IGlvc193ZWJraXRfZGVidWdfcHJveHkgc2VydmVyOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmlzU2FmYXJpKCkgfHwgdGhpcy5vcHRzLmF1dG9XZWJ2aWV3KSB7XG4gICAgICBsb2cuZGVidWcoJ1dhaXRpbmcgZm9yIGluaXRpYWwgd2VidmlldycpO1xuICAgICAgYXdhaXQgdGhpcy5uYXZUb0luaXRpYWxXZWJ2aWV3KCk7XG4gICAgICB0aGlzLmxvZ0V2ZW50KCdpbml0aWFsV2Vidmlld05hdmlnYXRlZCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzU2FmYXJpKCkgJiYgdGhpcy5pc1JlYWxEZXZpY2UoKSAmJiB1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPj0nLCAnMTIuMicpKSB7XG4gICAgICAvLyBvbiAxMi4yIHRoZSBwYWdlIGlzIG5vdCBvcGVuZWQgaW4gV0RBXG4gICAgICBhd2FpdCB0aGlzLnNldFVybCh0aGlzLl9jdXJyZW50VXJsKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGlmICh0aGlzLm9wdHMuY2FsZW5kYXJBY2Nlc3NBdXRob3JpemVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UuZW5hYmxlQ2FsZW5kYXJBY2Nlc3ModGhpcy5vcHRzLmJ1bmRsZUlkKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRzLmNhbGVuZGFyQWNjZXNzQXV0aG9yaXplZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5kaXNhYmxlQ2FsZW5kYXJBY2Nlc3ModGhpcy5vcHRzLmJ1bmRsZUlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3RhcnQgV2ViRHJpdmVyQWdlbnRSdW5uZXJcbiAgICogQHBhcmFtIHtzdHJpbmd9IHNlc3Npb25JZCAtIFRoZSBpZCBvZiB0aGUgdGFyZ2V0IHNlc3Npb24gdG8gbGF1bmNoIFdEQSB3aXRoLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHJlYWxEZXZpY2UgLSBFcXVhbHMgdG8gdHJ1ZSBpZiB0aGUgdGVzdCB0YXJnZXQgZGV2aWNlIGlzIGEgcmVhbCBkZXZpY2UuXG4gICAqL1xuICBhc3luYyBzdGFydFdkYSAoc2Vzc2lvbklkLCByZWFsRGV2aWNlKSB7XG4gICAgdGhpcy53ZGEgPSBuZXcgV2ViRHJpdmVyQWdlbnQodGhpcy54Y29kZVZlcnNpb24sIHRoaXMub3B0cyk7XG5cbiAgICAvLyBEb24ndCBjbGVhbnVwIHRoZSBwcm9jZXNzZXMgaWYgd2ViRHJpdmVyQWdlbnRVcmwgaXMgc2V0XG4gICAgaWYgKCF1dGlsLmhhc1ZhbHVlKHRoaXMud2RhLndlYkRyaXZlckFnZW50VXJsKSkge1xuICAgICAgYXdhaXQgdGhpcy53ZGEuY2xlYW51cE9ic29sZXRlUHJvY2Vzc2VzKCk7XG4gICAgfVxuICAgIC8vIExldCBtdWx0aXBsZSBXREEgYmluYXJpZXMgd2l0aCBkaWZmZXJlbnQgZGVyaXZlZCBkYXRhIGZvbGRlcnMgYmUgYnVpbHQgaW4gcGFyYWxsZWxcbiAgICAvLyBDb25jdXJyZW50IFdEQSBidWlsZHMgZnJvbSB0aGUgc2FtZSBzb3VyY2Ugd2lsbCBjYXVzZSB4Y29kZWJ1aWxkIHN5bmNocm9uaXphdGlvbiBlcnJvcnNcbiAgICBjb25zdCBzeW5jaHJvbml6YXRpb25LZXkgPSAhdGhpcy5vcHRzLnVzZVhjdGVzdHJ1bkZpbGUgJiYgYXdhaXQgdGhpcy53ZGEuaXNTb3VyY2VGcmVzaCgpXG4gICAgICAvLyBGaXJzdC10aW1lIGNvbXBpbGF0aW9uIGlzIGFuIGV4cGVuc2l2ZSBvcGVyYXRpb24sIHdoaWNoIGlzIGRvbmUgZmFzdGVyIGlmIGV4ZWN1dGVkXG4gICAgICAvLyBzZXF1ZW50aWFsbHkuIFhjb2RlYnVpbGQgc3ByZWFkcyB0aGUgbG9hZCBjYXVzZWQgYnkgdGhlIGNsYW5nIGNvbXBpbGVyIHRvIGFsbCBhdmFpbGFibGUgQ1BVIGNvcmVzXG4gICAgICA/IFhDVUlUZXN0RHJpdmVyLm5hbWVcbiAgICAgIDogcGF0aC5ub3JtYWxpemUoYXdhaXQgdGhpcy53ZGEucmV0cmlldmVEZXJpdmVkRGF0YVBhdGgoKSk7XG4gICAgbG9nLmRlYnVnKGBTdGFydGluZyBXZWJEcml2ZXJBZ2VudCBpbml0aWFsaXphdGlvbiB3aXRoIHRoZSBzeW5jaHJvbml6YXRpb24ga2V5ICcke3N5bmNocm9uaXphdGlvbktleX0nYCk7XG4gICAgaWYgKFNIQVJFRF9SRVNPVVJDRVNfR1VBUkQuaXNCdXN5KCkgJiYgIXRoaXMub3B0cy5kZXJpdmVkRGF0YVBhdGggJiYgIXRoaXMub3B0cy5ib290c3RyYXBQYXRoKSB7XG4gICAgICBsb2cuZGVidWcoYENvbnNpZGVyIHNldHRpbmcgYSB1bmlxdWUgJ2Rlcml2ZWREYXRhUGF0aCcgY2FwYWJpbGl0eSB2YWx1ZSBmb3IgZWFjaCBwYXJhbGxlbCBkcml2ZXIgaW5zdGFuY2UgYCArXG4gICAgICAgIGB0byBhdm9pZCBjb25mbGljdHMgYW5kIHNwZWVkIHVwIHRoZSBidWlsZGluZyBwcm9jZXNzYCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBTSEFSRURfUkVTT1VSQ0VTX0dVQVJELmFjcXVpcmUoc3luY2hyb25pemF0aW9uS2V5LCBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5vcHRzLnVzZU5ld1dEQSkge1xuICAgICAgICBsb2cuZGVidWcoYENhcGFiaWxpdHkgJ3VzZU5ld1dEQScgc2V0IHRvIHRydWUsIHNvIHVuaW5zdGFsbGluZyBXREEgYmVmb3JlIHByb2NlZWRpbmdgKTtcbiAgICAgICAgYXdhaXQgdGhpcy53ZGEucXVpdEFuZFVuaW5zdGFsbCgpO1xuICAgICAgICB0aGlzLmxvZ0V2ZW50KCd3ZGFVbmluc3RhbGxlZCcpO1xuICAgICAgfSBlbHNlIGlmICghdXRpbC5oYXNWYWx1ZSh0aGlzLndkYS53ZWJEcml2ZXJBZ2VudFVybCkpIHtcbiAgICAgICAgYXdhaXQgdGhpcy53ZGEuc2V0dXBDYWNoaW5nKHRoaXMub3B0cy51cGRhdGVkV0RBQnVuZGxlSWQpO1xuICAgICAgfVxuXG4gICAgICAvLyBsb2NhbCBoZWxwZXIgZm9yIHRoZSB0d28gcGxhY2VzIHdlIG5lZWQgdG8gdW5pbnN0YWxsIHdkYSBhbmQgcmUtc3RhcnQgaXRcbiAgICAgIGNvbnN0IHF1aXRBbmRVbmluc3RhbGwgPSBhc3luYyAobXNnKSA9PiB7XG4gICAgICAgIGxvZy5kZWJ1Zyhtc2cpO1xuICAgICAgICBpZiAodGhpcy5vcHRzLndlYkRyaXZlckFnZW50VXJsKSB7XG4gICAgICAgICAgbG9nLmRlYnVnKCdOb3QgcXVpdHRpbmcvdW5pbnN0YWxsaW5nIFdlYkRyaXZlckFnZW50IHNpbmNlIHdlYkRyaXZlckFnZW50VXJsIGNhcGFiaWxpdHkgaXMgcHJvdmlkZWQnKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgICAgICAgfVxuICAgICAgICBsb2cud2FybignUXVpdHRpbmcgYW5kIHVuaW5zdGFsbGluZyBXZWJEcml2ZXJBZ2VudCcpO1xuICAgICAgICBhd2FpdCB0aGlzLndkYS5xdWl0QW5kVW5pbnN0YWxsKCk7XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBzdGFydHVwUmV0cmllcyA9IHRoaXMub3B0cy53ZGFTdGFydHVwUmV0cmllcyB8fCAodGhpcy5pc1JlYWxEZXZpY2UoKSA/IFdEQV9SRUFMX0RFVl9TVEFSVFVQX1JFVFJJRVMgOiBXREFfU0lNX1NUQVJUVVBfUkVUUklFUyk7XG4gICAgICBjb25zdCBzdGFydHVwUmV0cnlJbnRlcnZhbCA9IHRoaXMub3B0cy53ZGFTdGFydHVwUmV0cnlJbnRlcnZhbCB8fCBXREFfU1RBUlRVUF9SRVRSWV9JTlRFUlZBTDtcbiAgICAgIGxvZy5kZWJ1ZyhgVHJ5aW5nIHRvIHN0YXJ0IFdlYkRyaXZlckFnZW50ICR7c3RhcnR1cFJldHJpZXN9IHRpbWVzIHdpdGggJHtzdGFydHVwUmV0cnlJbnRlcnZhbH1tcyBpbnRlcnZhbGApO1xuICAgICAgaWYgKCF1dGlsLmhhc1ZhbHVlKHRoaXMub3B0cy53ZGFTdGFydHVwUmV0cmllcykgJiYgIXV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLndkYVN0YXJ0dXBSZXRyeUludGVydmFsKSkge1xuICAgICAgICBsb2cuZGVidWcoYFRoZXNlIHZhbHVlcyBjYW4gYmUgY3VzdG9taXplZCBieSBjaGFuZ2luZyB3ZGFTdGFydHVwUmV0cmllcy93ZGFTdGFydHVwUmV0cnlJbnRlcnZhbCBjYXBhYmlsaXRpZXNgKTtcbiAgICAgIH1cbiAgICAgIGxldCByZXRyeUNvdW50ID0gMDtcbiAgICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoc3RhcnR1cFJldHJpZXMsIHN0YXJ0dXBSZXRyeUludGVydmFsLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMubG9nRXZlbnQoJ3dkYVN0YXJ0QXR0ZW1wdGVkJyk7XG4gICAgICAgIGlmIChyZXRyeUNvdW50ID4gMCkge1xuICAgICAgICAgIGxvZy5pbmZvKGBSZXRyeWluZyBXREEgc3RhcnR1cCAoJHtyZXRyeUNvdW50ICsgMX0gb2YgJHtzdGFydHVwUmV0cmllc30pYCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBvbiB4Y29kZSAxMCBpbnN0YWxsZCB3aWxsIG9mdGVuIHRyeSB0byBhY2Nlc3MgdGhlIGFwcCBmcm9tIGl0cyBzdGFnaW5nXG4gICAgICAgICAgLy8gZGlyZWN0b3J5IGJlZm9yZSBmdWxseSBtb3ZpbmcgaXQgdGhlcmUsIGFuZCBmYWlsLiBSZXRyeWluZyBvbmNlXG4gICAgICAgICAgLy8gaW1tZWRpYXRlbHkgaGVscHNcbiAgICAgICAgICBjb25zdCByZXRyaWVzID0gdGhpcy54Y29kZVZlcnNpb24ubWFqb3IgPj0gMTAgPyAyIDogMTtcbiAgICAgICAgICB0aGlzLmNhY2hlZFdkYVN0YXR1cyA9IGF3YWl0IHJldHJ5KHJldHJpZXMsIHRoaXMud2RhLmxhdW5jaC5iaW5kKHRoaXMud2RhKSwgc2Vzc2lvbklkLCByZWFsRGV2aWNlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgdGhpcy5sb2dFdmVudCgnd2RhU3RhcnRGYWlsZWQnKTtcbiAgICAgICAgICByZXRyeUNvdW50Kys7XG4gICAgICAgICAgbGV0IGVycm9yTXNnID0gYFVuYWJsZSB0byBsYXVuY2ggV2ViRHJpdmVyQWdlbnQgYmVjYXVzZSBvZiB4Y29kZWJ1aWxkIGZhaWx1cmU6ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICAgICAgICBpZiAodGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgICAgICAgICAgZXJyb3JNc2cgKz0gYC4gTWFrZSBzdXJlIHlvdSBmb2xsb3cgdGhlIHR1dG9yaWFsIGF0ICR7V0RBX1JFQUxfREVWX1RVVE9SSUFMX1VSTH0uIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYFRyeSB0byByZW1vdmUgdGhlIFdlYkRyaXZlckFnZW50UnVubmVyIGFwcGxpY2F0aW9uIGZyb20gdGhlIGRldmljZSBpZiBpdCBpcyBpbnN0YWxsZWQgYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgYW5kIHJlYm9vdCB0aGUgZGV2aWNlLmA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGF3YWl0IHF1aXRBbmRVbmluc3RhbGwoZXJyb3JNc2cpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wcm94eVJlcVJlcyA9IHRoaXMud2RhLnByb3h5UmVxUmVzLmJpbmQodGhpcy53ZGEpO1xuICAgICAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICBsZXQgb3JpZ2luYWxTdGFja3RyYWNlID0gbnVsbDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCByZXRyeUludGVydmFsKDE1LCAxMDAwLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxvZ0V2ZW50KCd3ZGFTZXNzaW9uQXR0ZW1wdGVkJyk7XG4gICAgICAgICAgICBsb2cuZGVidWcoJ1NlbmRpbmcgY3JlYXRlU2Vzc2lvbiBjb21tYW5kIHRvIFdEQScpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgdGhpcy5jYWNoZWRXZGFTdGF0dXMgPSB0aGlzLmNhY2hlZFdkYVN0YXR1cyB8fCBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZCgnL3N0YXR1cycsICdHRVQnKTtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zdGFydFdkYVNlc3Npb24odGhpcy5vcHRzLmJ1bmRsZUlkLCB0aGlzLm9wdHMucHJvY2Vzc0FyZ3VtZW50cyk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgb3JpZ2luYWxTdGFja3RyYWNlID0gZXJyLnN0YWNrO1xuICAgICAgICAgICAgICBsb2cuZGVidWcoYEZhaWxlZCB0byBjcmVhdGUgV0RBIHNlc3Npb24gKCR7ZXJyLm1lc3NhZ2V9KS4gUmV0cnlpbmcuLi5gKTtcbiAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMubG9nRXZlbnQoJ3dkYVNlc3Npb25TdGFydGVkJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGlmIChvcmlnaW5hbFN0YWNrdHJhY2UpIHtcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyhvcmlnaW5hbFN0YWNrdHJhY2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsZXQgZXJyb3JNc2cgPSBgVW5hYmxlIHRvIHN0YXJ0IFdlYkRyaXZlckFnZW50IHNlc3Npb24gYmVjYXVzZSBvZiB4Y29kZWJ1aWxkIGZhaWx1cmU6ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICAgICAgICBpZiAodGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgICAgICAgICAgZXJyb3JNc2cgKz0gYCBNYWtlIHN1cmUgeW91IGZvbGxvdyB0aGUgdHV0b3JpYWwgYXQgJHtXREFfUkVBTF9ERVZfVFVUT1JJQUxfVVJMfS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgVHJ5IHRvIHJlbW92ZSB0aGUgV2ViRHJpdmVyQWdlbnRSdW5uZXIgYXBwbGljYXRpb24gZnJvbSB0aGUgZGV2aWNlIGlmIGl0IGlzIGluc3RhbGxlZCBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGBhbmQgcmVib290IHRoZSBkZXZpY2UuYDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgcXVpdEFuZFVuaW5zdGFsbChlcnJvck1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRzLmNsZWFyU3lzdGVtRmlsZXMgJiYgIXRoaXMub3B0cy53ZWJEcml2ZXJBZ2VudFVybCkge1xuICAgICAgICAgIGF3YWl0IG1hcmtTeXN0ZW1GaWxlc0ZvckNsZWFudXAodGhpcy53ZGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gd2UgZXhwZWN0IGNlcnRhaW4gc29ja2V0IGVycm9ycyB1bnRpbCB0aGlzIHBvaW50LCBidXQgbm93XG4gICAgICAgIC8vIG1hcmsgdGhpbmdzIGFzIGZ1bGx5IHdvcmtpbmdcbiAgICAgICAgdGhpcy53ZGEuZnVsbHlTdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5sb2dFdmVudCgnd2RhU3RhcnRlZCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBydW5SZXNldCAob3B0cyA9IG51bGwpIHtcbiAgICB0aGlzLmxvZ0V2ZW50KCdyZXNldFN0YXJ0ZWQnKTtcbiAgICBpZiAodGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgICAgYXdhaXQgcnVuUmVhbERldmljZVJlc2V0KHRoaXMub3B0cy5kZXZpY2UsIG9wdHMgfHwgdGhpcy5vcHRzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgcnVuU2ltdWxhdG9yUmVzZXQodGhpcy5vcHRzLmRldmljZSwgb3B0cyB8fCB0aGlzLm9wdHMpO1xuICAgIH1cbiAgICB0aGlzLmxvZ0V2ZW50KCdyZXNldENvbXBsZXRlJyk7XG4gIH1cblxuICBhc3luYyBkZWxldGVTZXNzaW9uICgpIHtcbiAgICBhd2FpdCByZW1vdmVBbGxTZXNzaW9uV2ViU29ja2V0SGFuZGxlcnModGhpcy5zZXJ2ZXIsIHRoaXMuc2Vzc2lvbklkKTtcblxuICAgIGlmICh0aGlzLmlzU2ltdWxhdG9yKCkgJiYgKHRoaXMub3B0cy5kZXZpY2UgfHwge30pLmlkYikge1xuICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5pZGIuZGlzY29ubmVjdCgpO1xuICAgICAgdGhpcy5vcHRzLmRldmljZS5pZGIgPSBudWxsO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc3RvcCgpO1xuXG4gICAgaWYgKHRoaXMub3B0cy5jbGVhclN5c3RlbUZpbGVzICYmIHRoaXMuaXNBcHBUZW1wb3JhcnkpIHtcbiAgICAgIGF3YWl0IGZzLnJpbXJhZih0aGlzLm9wdHMuYXBwKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy53ZGEgJiYgIXRoaXMub3B0cy53ZWJEcml2ZXJBZ2VudFVybCkge1xuICAgICAgY29uc3Qgc3luY2hyb25pemF0aW9uS2V5ID0gcGF0aC5ub3JtYWxpemUoYXdhaXQgdGhpcy53ZGEucmV0cmlldmVEZXJpdmVkRGF0YVBhdGgoKSk7XG4gICAgICBhd2FpdCBTSEFSRURfUkVTT1VSQ0VTX0dVQVJELmFjcXVpcmUoc3luY2hyb25pemF0aW9uS2V5LCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLm9wdHMuY2xlYXJTeXN0ZW1GaWxlcykge1xuICAgICAgICAgIGF3YWl0IGNsZWFyU3lzdGVtRmlsZXModGhpcy53ZGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy5kZWJ1ZygnTm90IGNsZWFyaW5nIGxvZyBmaWxlcy4gVXNlIGBjbGVhclN5c3RlbUZpbGVzYCBjYXBhYmlsaXR5IHRvIHR1cm4gb24uJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgICBsb2cuZGVidWcoJ0luIGEgd2ViIHNlc3Npb24uIFJlbW92aW5nIHJlbW90ZSBkZWJ1Z2dlcicpO1xuICAgICAgYXdhaXQgdGhpcy5zdG9wUmVtb3RlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0cy5yZXNldE9uU2Vzc2lvblN0YXJ0T25seSA9PT0gZmFsc2UpIHtcbiAgICAgIGF3YWl0IHRoaXMucnVuUmVzZXQoT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5vcHRzLCB7XG4gICAgICAgIGVuZm9yY2VTaW11bGF0b3JTaHV0ZG93bjogdHJ1ZSxcbiAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pc1NpbXVsYXRvcigpICYmICF0aGlzLm9wdHMubm9SZXNldCAmJiAhIXRoaXMub3B0cy5kZXZpY2UpIHtcbiAgICAgIGlmICh0aGlzLmxpZmVjeWNsZURhdGEuY3JlYXRlU2ltKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgRGVsZXRpbmcgc2ltdWxhdG9yIGNyZWF0ZWQgZm9yIHRoaXMgcnVuICh1ZGlkOiAnJHt0aGlzLm9wdHMudWRpZH0nKWApO1xuICAgICAgICBhd2FpdCBzaHV0ZG93blNpbXVsYXRvcih0aGlzLm9wdHMuZGV2aWNlKTtcbiAgICAgICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5kZWxldGUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIV8uaXNFbXB0eSh0aGlzLmxvZ3MpKSB7XG4gICAgICBhd2FpdCB0aGlzLmxvZ3Muc3lzbG9nLnN0b3BDYXB0dXJlKCk7XG4gICAgICB0aGlzLmxvZ3MgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5pd2RwU2VydmVyKSB7XG4gICAgICBhd2FpdCB0aGlzLnN0b3BJV0RQKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMub3B0cy5lbmFibGVBc3luY0V4ZWN1dGVGcm9tSHR0cHMgJiYgIXRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGF3YWl0IHRoaXMuc3RvcEh0dHBzQXN5bmNTZXJ2ZXIoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5tanBlZ1N0cmVhbSkge1xuICAgICAgbG9nLmluZm8oJ0Nsb3NpbmcgTUpQRUcgc3RyZWFtJyk7XG4gICAgICB0aGlzLm1qcGVnU3RyZWFtLnN0b3AoKTtcbiAgICB9XG5cbiAgICB0aGlzLnJlc2V0SW9zKCk7XG5cbiAgICBhd2FpdCBzdXBlci5kZWxldGVTZXNzaW9uKCk7XG4gIH1cblxuICBhc3luYyBzdG9wICgpIHtcbiAgICB0aGlzLmp3cFByb3h5QWN0aXZlID0gZmFsc2U7XG4gICAgdGhpcy5wcm94eVJlcVJlcyA9IG51bGw7XG5cbiAgICBpZiAodGhpcy53ZGEgJiYgdGhpcy53ZGEuZnVsbHlTdGFydGVkKSB7XG4gICAgICBpZiAodGhpcy53ZGEuandwcm94eSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKGAvc2Vzc2lvbi8ke3RoaXMuc2Vzc2lvbklkfWAsICdERUxFVEUnKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgLy8gYW4gZXJyb3IgaGVyZSBzaG91bGQgbm90IHNob3J0LWNpcmN1aXQgdGhlIHJlc3Qgb2YgY2xlYW4gdXBcbiAgICAgICAgICBsb2cuZGVidWcoYFVuYWJsZSB0byBERUxFVEUgc2Vzc2lvbiBvbiBXREE6ICcke2Vyci5tZXNzYWdlfScuIENvbnRpbnVpbmcgc2h1dGRvd24uYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLndkYSAmJiAhdGhpcy53ZGEud2ViRHJpdmVyQWdlbnRVcmwgJiYgdGhpcy5vcHRzLnVzZU5ld1dEQSkge1xuICAgICAgICBhd2FpdCB0aGlzLndkYS5xdWl0KCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZUNvbW1hbmQgKGNtZCwgLi4uYXJncykge1xuICAgIGxvZy5kZWJ1ZyhgRXhlY3V0aW5nIGNvbW1hbmQgJyR7Y21kfSdgKTtcblxuICAgIGlmIChjbWQgPT09ICdyZWNlaXZlQXN5bmNSZXNwb25zZScpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlY2VpdmVBc3luY1Jlc3BvbnNlKC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvLyBUT0RPOiBvbmNlIHRoaXMgZml4IGdldHMgaW50byBiYXNlIGRyaXZlciByZW1vdmUgZnJvbSBoZXJlXG4gICAgaWYgKGNtZCA9PT0gJ2dldFN0YXR1cycpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFN0YXR1cygpO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgc3VwZXIuZXhlY3V0ZUNvbW1hbmQoY21kLCAuLi5hcmdzKTtcbiAgfVxuXG4gIGFzeW5jIGNvbmZpZ3VyZUFwcCAoKSB7XG4gICAgZnVuY3Rpb24gYXBwSXNQYWNrYWdlT3JCdW5kbGUgKGFwcCkge1xuICAgICAgcmV0dXJuICgvXihbYS16QS1aMC05XFwtX10rXFwuW2EtekEtWjAtOVxcLV9dKykrJC8pLnRlc3QoYXBwKTtcbiAgICB9XG5cbiAgICAvLyB0aGUgYXBwIG5hbWUgaXMgYSBidW5kbGVJZCBhc3NpZ24gaXQgdG8gdGhlIGJ1bmRsZUlkIHByb3BlcnR5XG4gICAgaWYgKCF0aGlzLm9wdHMuYnVuZGxlSWQgJiYgYXBwSXNQYWNrYWdlT3JCdW5kbGUodGhpcy5vcHRzLmFwcCkpIHtcbiAgICAgIHRoaXMub3B0cy5idW5kbGVJZCA9IHRoaXMub3B0cy5hcHA7XG4gICAgICB0aGlzLm9wdHMuYXBwID0gJyc7XG4gICAgfVxuICAgIC8vIHdlIGhhdmUgYSBidW5kbGUgSUQsIGJ1dCBubyBhcHAsIG9yIGFwcCBpcyBhbHNvIGEgYnVuZGxlXG4gICAgaWYgKCh0aGlzLm9wdHMuYnVuZGxlSWQgJiYgYXBwSXNQYWNrYWdlT3JCdW5kbGUodGhpcy5vcHRzLmJ1bmRsZUlkKSkgJiZcbiAgICAgICAgKHRoaXMub3B0cy5hcHAgPT09ICcnIHx8IGFwcElzUGFja2FnZU9yQnVuZGxlKHRoaXMub3B0cy5hcHApKSkge1xuICAgICAgbG9nLmRlYnVnKCdBcHAgaXMgYW4gaU9TIGJ1bmRsZSwgd2lsbCBhdHRlbXB0IHRvIHJ1biBhcyBwcmUtZXhpc3RpbmcnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBjaGVjayBmb3Igc3VwcG9ydGVkIGJ1aWxkLWluIGFwcHNcbiAgICBpZiAodGhpcy5vcHRzLmFwcCAmJiB0aGlzLm9wdHMuYXBwLnRvTG93ZXJDYXNlKCkgPT09ICdzZXR0aW5ncycpIHtcbiAgICAgIHRoaXMub3B0cy5idW5kbGVJZCA9ICdjb20uYXBwbGUuUHJlZmVyZW5jZXMnO1xuICAgICAgdGhpcy5vcHRzLmFwcCA9IG51bGw7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmICh0aGlzLm9wdHMuYXBwICYmIHRoaXMub3B0cy5hcHAudG9Mb3dlckNhc2UoKSA9PT0gJ2NhbGVuZGFyJykge1xuICAgICAgdGhpcy5vcHRzLmJ1bmRsZUlkID0gJ2NvbS5hcHBsZS5tb2JpbGVjYWwnO1xuICAgICAgdGhpcy5vcHRzLmFwcCA9IG51bGw7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgb3JpZ2luYWxBcHBQYXRoID0gdGhpcy5vcHRzLmFwcDtcbiAgICB0cnkge1xuICAgICAgLy8gZG93bmxvYWQgaWYgbmVjZXNzYXJ5XG4gICAgICB0aGlzLm9wdHMuYXBwID0gYXdhaXQgdGhpcy5oZWxwZXJzLmNvbmZpZ3VyZUFwcCh0aGlzLm9wdHMuYXBwLCAnLmFwcCcpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbG9nLmVycm9yKGVycik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEJhZCBhcHA6ICR7dGhpcy5vcHRzLmFwcH0uIEFwcCBwYXRocyBuZWVkIHRvIGJlIGFic29sdXRlIG9yIGFuIFVSTCB0byBhIGNvbXByZXNzZWQgYXBwIGZpbGUke2VyciAmJiBlcnIubWVzc2FnZSA/IGA6ICR7ZXJyLm1lc3NhZ2V9YCA6ICcnfWApO1xuICAgIH1cbiAgICB0aGlzLmlzQXBwVGVtcG9yYXJ5ID0gdGhpcy5vcHRzLmFwcCAmJiBhd2FpdCBmcy5leGlzdHModGhpcy5vcHRzLmFwcClcbiAgICAgICYmICFhd2FpdCB1dGlsLmlzU2FtZURlc3RpbmF0aW9uKG9yaWdpbmFsQXBwUGF0aCwgdGhpcy5vcHRzLmFwcCk7XG4gIH1cblxuICBhc3luYyBkZXRlcm1pbmVEZXZpY2UgKCkge1xuICAgIC8vIGluIHRoZSBvbmUgY2FzZSB3aGVyZSB3ZSBjcmVhdGUgYSBzaW0sIHdlIHdpbGwgc2V0IHRoaXMgc3RhdGVcbiAgICB0aGlzLmxpZmVjeWNsZURhdGEuY3JlYXRlU2ltID0gZmFsc2U7XG5cbiAgICAvLyBpZiB3ZSBnZXQgZ2VuZXJpYyBuYW1lcywgdHJhbnNsYXRlIHRoZW1cbiAgICB0aGlzLm9wdHMuZGV2aWNlTmFtZSA9IHRyYW5zbGF0ZURldmljZU5hbWUodGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbiwgdGhpcy5vcHRzLmRldmljZU5hbWUpO1xuXG4gICAgY29uc3Qgc2V0dXBWZXJzaW9uQ2FwcyA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRoaXMub3B0cy5pb3NTZGtWZXJzaW9uID0gYXdhaXQgZ2V0QW5kQ2hlY2tJb3NTZGtWZXJzaW9uKCk7XG4gICAgICBsb2cuaW5mbyhgaU9TIFNESyBWZXJzaW9uIHNldCB0byAnJHt0aGlzLm9wdHMuaW9zU2RrVmVyc2lvbn0nYCk7XG4gICAgICBpZiAoIXRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gJiYgdGhpcy5vcHRzLmlvc1Nka1ZlcnNpb24pIHtcbiAgICAgICAgbG9nLmluZm8oYE5vIHBsYXRmb3JtVmVyc2lvbiBzcGVjaWZpZWQuIFVzaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBYY29kZSBzdXBwb3J0czogJyR7dGhpcy5vcHRzLmlvc1Nka1ZlcnNpb259Jy4gYCArXG4gICAgICAgICAgYFRoaXMgbWF5IGNhdXNlIHByb2JsZW1zIGlmIGEgc2ltdWxhdG9yIGRvZXMgbm90IGV4aXN0IGZvciB0aGlzIHBsYXRmb3JtIHZlcnNpb24uYCk7XG4gICAgICAgIHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gPSBub3JtYWxpemVQbGF0Zm9ybVZlcnNpb24odGhpcy5vcHRzLmlvc1Nka1ZlcnNpb24pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5vcHRzLnVkaWQpIHtcbiAgICAgIGlmICh0aGlzLm9wdHMudWRpZC50b0xvd2VyQ2FzZSgpID09PSAnYXV0bycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0aGlzLm9wdHMudWRpZCA9IGF3YWl0IGRldGVjdFVkaWQoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgLy8gVHJ5aW5nIHRvIGZpbmQgbWF0Y2hpbmcgVURJRCBmb3IgU2ltdWxhdG9yXG4gICAgICAgICAgbG9nLndhcm4oYENhbm5vdCBkZXRlY3QgYW55IGNvbm5lY3RlZCByZWFsIGRldmljZXMuIEZhbGxpbmcgYmFjayB0byBTaW11bGF0b3IuIE9yaWdpbmFsIGVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IGdldEV4aXN0aW5nU2ltKHRoaXMub3B0cyk7XG4gICAgICAgICAgaWYgKCFkZXZpY2UpIHtcbiAgICAgICAgICAgIC8vIE5vIG1hdGNoaW5nIFNpbXVsYXRvciBpcyBmb3VuZC4gVGhyb3cgYW4gZXJyb3JcbiAgICAgICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBDYW5ub3QgZGV0ZWN0IHVkaWQgZm9yICR7dGhpcy5vcHRzLmRldmljZU5hbWV9IFNpbXVsYXRvciBydW5uaW5nIGlPUyAke3RoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb259YCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gTWF0Y2hpbmcgU2ltdWxhdG9yIGV4aXN0cyBhbmQgaXMgZm91bmQuIFVzZSBpdFxuICAgICAgICAgIHRoaXMub3B0cy51ZGlkID0gZGV2aWNlLnVkaWQ7XG4gICAgICAgICAgY29uc3QgZGV2aWNlUGxhdGZvcm0gPSBub3JtYWxpemVQbGF0Zm9ybVZlcnNpb24oYXdhaXQgZGV2aWNlLmdldFBsYXRmb3JtVmVyc2lvbigpKTtcbiAgICAgICAgICBpZiAodGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbiAhPT0gZGV2aWNlUGxhdGZvcm0pIHtcbiAgICAgICAgICAgIHRoaXMub3B0cy5wbGF0Zm9ybVZlcnNpb24gPSBkZXZpY2VQbGF0Zm9ybTtcbiAgICAgICAgICAgIGxvZy5pbmZvKGBTZXQgcGxhdGZvcm1WZXJzaW9uIHRvICcke2RldmljZVBsYXRmb3JtfScgdG8gbWF0Y2ggdGhlIGRldmljZSB3aXRoIGdpdmVuIFVESURgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgc2V0dXBWZXJzaW9uQ2FwcygpO1xuICAgICAgICAgIHJldHVybiB7ZGV2aWNlLCByZWFsRGV2aWNlOiBmYWxzZSwgdWRpZDogZGV2aWNlLnVkaWR9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBtYWtlIHN1cmUgaXQgaXMgYSBjb25uZWN0ZWQgZGV2aWNlLiBJZiBub3QsIHRoZSB1ZGlkIHBhc3NlZCBpbiBpcyBpbnZhbGlkXG4gICAgICAgIGNvbnN0IGRldmljZXMgPSBhd2FpdCBnZXRDb25uZWN0ZWREZXZpY2VzKCk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgQXZhaWxhYmxlIGRldmljZXM6ICR7ZGV2aWNlcy5qb2luKCcsICcpfWApO1xuICAgICAgICBpZiAoIWRldmljZXMuaW5jbHVkZXModGhpcy5vcHRzLnVkaWQpKSB7XG4gICAgICAgICAgLy8gY2hlY2sgZm9yIGEgcGFydGljdWxhciBzaW11bGF0b3JcbiAgICAgICAgICBpZiAoYXdhaXQgc2ltRXhpc3RzKHRoaXMub3B0cy51ZGlkKSkge1xuICAgICAgICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgZ2V0U2ltdWxhdG9yKHRoaXMub3B0cy51ZGlkKTtcbiAgICAgICAgICAgIHJldHVybiB7ZGV2aWNlLCByZWFsRGV2aWNlOiBmYWxzZSwgdWRpZDogdGhpcy5vcHRzLnVkaWR9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBkZXZpY2Ugb3Igc2ltdWxhdG9yIFVESUQ6ICcke3RoaXMub3B0cy51ZGlkfSdgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCBkZXZpY2UgPSBhd2FpdCBnZXRSZWFsRGV2aWNlT2JqKHRoaXMub3B0cy51ZGlkKTtcbiAgICAgIGlmIChfLmlzRW1wdHkodGhpcy5vcHRzLnBsYXRmb3JtVmVyc2lvbikpIHtcbiAgICAgICAgbG9nLmluZm8oJ0dldHRpbmcgdGhlIHBsYXRmb3JtVmVyc2lvbiBmcm9tIHRoZSBwaG9uZSBzaW5jZSBpdCB3YXMgbm90IHNwZWNpZmllZCBpbiB0aGUgY2FwYWJpbGl0aWVzJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgb3NWZXJzaW9uID0gYXdhaXQgZ2V0T1NWZXJzaW9uKHRoaXMub3B0cy51ZGlkKTtcbiAgICAgICAgICB0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uID0gdXRpbC5jb2VyY2VWZXJzaW9uKG9zVmVyc2lvbik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBsb2cud2FybihgQ2Fubm90IGRldGVybWluZSByZWFsIGRldmljZSBwbGF0Zm9ybSB2ZXJzaW9uLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7ZGV2aWNlLCByZWFsRGV2aWNlOiB0cnVlLCB1ZGlkOiB0aGlzLm9wdHMudWRpZH07XG4gICAgfVxuXG4gICAgLy8gTm93IHdlIGtub3cgZm9yIHN1cmUgdGhlIGRldmljZSB3aWxsIGJlIGEgU2ltdWxhdG9yXG4gICAgYXdhaXQgc2V0dXBWZXJzaW9uQ2FwcygpO1xuICAgIGlmICh0aGlzLm9wdHMuZW5mb3JjZUZyZXNoU2ltdWxhdG9yQ3JlYXRpb24pIHtcbiAgICAgIGxvZy5kZWJ1ZyhgTmV3IHNpbXVsYXRvciBpcyByZXF1ZXN0ZWQuIElmIHRoaXMgaXMgbm90IHdhbnRlZCwgc2V0ICdlbmZvcmNlRnJlc2hTaW11bGF0b3JDcmVhdGlvbicgY2FwYWJpbGl0eSB0byBmYWxzZWApO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBmaWd1cmUgb3V0IHRoZSBjb3JyZWN0IHNpbXVsYXRvciB0byB1c2UsIGdpdmVuIHRoZSBkZXNpcmVkIGNhcGFiaWxpdGllc1xuICAgICAgY29uc3QgZGV2aWNlID0gYXdhaXQgZ2V0RXhpc3RpbmdTaW0odGhpcy5vcHRzKTtcblxuICAgICAgLy8gY2hlY2sgZm9yIGFuIGV4aXN0aW5nIHNpbXVsYXRvclxuICAgICAgaWYgKGRldmljZSkge1xuICAgICAgICByZXR1cm4ge2RldmljZSwgcmVhbERldmljZTogZmFsc2UsIHVkaWQ6IGRldmljZS51ZGlkfTtcbiAgICAgIH1cblxuICAgICAgbG9nLmluZm8oJ1NpbXVsYXRvciB1ZGlkIG5vdCBwcm92aWRlZCcpO1xuICAgIH1cblxuICAgIC8vIG5vIGRldmljZSBvZiB0aGlzIHR5cGUgZXhpc3RzLCBvciB0aGV5IHJlcXVlc3QgbmV3IHNpbSwgc28gY3JlYXRlIG9uZVxuICAgIGxvZy5pbmZvKCdVc2luZyBkZXNpcmVkIGNhcHMgdG8gY3JlYXRlIGEgbmV3IHNpbXVsYXRvcicpO1xuICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IHRoaXMuY3JlYXRlU2ltKCk7XG4gICAgcmV0dXJuIHtkZXZpY2UsIHJlYWxEZXZpY2U6IGZhbHNlLCB1ZGlkOiBkZXZpY2UudWRpZH07XG4gIH1cblxuICBhc3luYyBzdGFydFNpbSAoKSB7XG4gICAgY29uc3QgcnVuT3B0cyA9IHtcbiAgICAgIHNjYWxlRmFjdG9yOiB0aGlzLm9wdHMuc2NhbGVGYWN0b3IsXG4gICAgICBjb25uZWN0SGFyZHdhcmVLZXlib2FyZDogISF0aGlzLm9wdHMuY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQsXG4gICAgICBpc0hlYWRsZXNzOiAhIXRoaXMub3B0cy5pc0hlYWRsZXNzLFxuICAgICAgZGV2aWNlUHJlZmVyZW5jZXM6IHt9LFxuICAgIH07XG5cbiAgICAvLyBhZGQgdGhlIHdpbmRvdyBjZW50ZXIsIGlmIGl0IGlzIHNwZWNpZmllZFxuICAgIGlmICh0aGlzLm9wdHMuU2ltdWxhdG9yV2luZG93Q2VudGVyKSB7XG4gICAgICBydW5PcHRzLmRldmljZVByZWZlcmVuY2VzLlNpbXVsYXRvcldpbmRvd0NlbnRlciA9IHRoaXMub3B0cy5TaW11bGF0b3JXaW5kb3dDZW50ZXI7XG4gICAgfVxuXG4gICAgLy8gVGhpcyBpcyB0byB3b3JrYXJvdW5kIFhDVGVzdCBidWcgYWJvdXQgY2hhbmdpbmcgU2ltdWxhdG9yXG4gICAgLy8gb3JpZW50YXRpb24gaXMgbm90IHN5bmNocm9uaXplZCB0byB0aGUgYWN0dWFsIHdpbmRvdyBvcmllbnRhdGlvblxuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gXy5pc1N0cmluZyh0aGlzLm9wdHMub3JpZW50YXRpb24pICYmIHRoaXMub3B0cy5vcmllbnRhdGlvbi50b1VwcGVyQ2FzZSgpO1xuICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcbiAgICAgIGNhc2UgJ0xBTkRTQ0FQRSc6XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb24gPSAnTGFuZHNjYXBlTGVmdCc7XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSA9IDkwO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1BPUlRSQUlUJzpcbiAgICAgICAgcnVuT3B0cy5kZXZpY2VQcmVmZXJlbmNlcy5TaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbiA9ICdQb3J0cmFpdCc7XG4gICAgICAgIHJ1bk9wdHMuZGV2aWNlUHJlZmVyZW5jZXMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSA9IDA7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMub3B0cy5kZXZpY2UucnVuKHJ1bk9wdHMpO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlU2ltICgpIHtcbiAgICB0aGlzLmxpZmVjeWNsZURhdGEuY3JlYXRlU2ltID0gdHJ1ZTtcblxuICAgIC8vIEdldCBwbGF0Zm9ybSBuYW1lIGZyb20gY29uc3Qgc2luY2UgaXQgbXVzdCBiZSBjYXNlIHNlbnNpdGl2ZSB0byBjcmVhdGUgYSBuZXcgc2ltdWxhdG9yXG4gICAgY29uc3QgcGxhdGZvcm1OYW1lID0gaXNUdk9TKHRoaXMub3B0cy5wbGF0Zm9ybU5hbWUpID8gUExBVEZPUk1fTkFNRV9UVk9TIDogUExBVEZPUk1fTkFNRV9JT1M7XG5cbiAgICAvLyBjcmVhdGUgc2ltIGZvciBjYXBzXG4gICAgbGV0IHNpbSA9IGF3YWl0IGNyZWF0ZVNpbSh0aGlzLm9wdHMsIHBsYXRmb3JtTmFtZSk7XG4gICAgbG9nLmluZm8oYENyZWF0ZWQgc2ltdWxhdG9yIHdpdGggdWRpZCAnJHtzaW0udWRpZH0nLmApO1xuXG4gICAgcmV0dXJuIHNpbTtcbiAgfVxuXG4gIGFzeW5jIGxhdW5jaEFwcCAoKSB7XG4gICAgY29uc3QgQVBQX0xBVU5DSF9USU1FT1VUID0gMjAgKiAxMDAwO1xuXG4gICAgdGhpcy5sb2dFdmVudCgnYXBwTGF1bmNoQXR0ZW1wdGVkJyk7XG4gICAgYXdhaXQgbGF1bmNoKHRoaXMub3B0cy5kZXZpY2UudWRpZCwgdGhpcy5vcHRzLmJ1bmRsZUlkKTtcblxuICAgIGxldCBjaGVja1N0YXR1cyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvc3RhdHVzJywgJ0dFVCcpO1xuICAgICAgbGV0IGN1cnJlbnRBcHAgPSByZXNwb25zZS5jdXJyZW50QXBwLmJ1bmRsZUlEO1xuICAgICAgaWYgKGN1cnJlbnRBcHAgIT09IHRoaXMub3B0cy5idW5kbGVJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7dGhpcy5vcHRzLmJ1bmRsZUlkfSBub3QgaW4gZm9yZWdyb3VuZC4gJHtjdXJyZW50QXBwfSBpcyBpbiBmb3JlZ3JvdW5kYCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGxvZy5pbmZvKGBXYWl0aW5nIGZvciAnJHt0aGlzLm9wdHMuYnVuZGxlSWR9JyB0byBiZSBpbiBmb3JlZ3JvdW5kYCk7XG4gICAgbGV0IHJldHJpZXMgPSBwYXJzZUludChBUFBfTEFVTkNIX1RJTUVPVVQgLyAyMDAsIDEwKTtcbiAgICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDIwMCwgY2hlY2tTdGF0dXMpO1xuICAgIGxvZy5pbmZvKGAke3RoaXMub3B0cy5idW5kbGVJZH0gaXMgaW4gZm9yZWdyb3VuZGApO1xuICAgIHRoaXMubG9nRXZlbnQoJ2FwcExhdW5jaGVkJyk7XG4gIH1cblxuICBhc3luYyBzdGFydFdkYVNlc3Npb24gKGJ1bmRsZUlkLCBwcm9jZXNzQXJndW1lbnRzKSB7XG4gICAgbGV0IGFyZ3MgPSBwcm9jZXNzQXJndW1lbnRzID8gKHByb2Nlc3NBcmd1bWVudHMuYXJncyB8fCBbXSkgOiBbXTtcbiAgICBpZiAoIV8uaXNBcnJheShhcmdzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBwcm9jZXNzQXJndW1lbnRzLmFyZ3MgY2FwYWJpbGl0eSBpcyBleHBlY3RlZCB0byBiZSBhbiBhcnJheS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7SlNPTi5zdHJpbmdpZnkoYXJncyl9IGlzIGdpdmVuIGluc3RlYWRgKTtcbiAgICB9XG4gICAgbGV0IGVudiA9IHByb2Nlc3NBcmd1bWVudHMgPyAocHJvY2Vzc0FyZ3VtZW50cy5lbnYgfHwge30pIDoge307XG4gICAgaWYgKCFfLmlzUGxhaW5PYmplY3QoZW52KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBwcm9jZXNzQXJndW1lbnRzLmVudiBjYXBhYmlsaXR5IGlzIGV4cGVjdGVkIHRvIGJlIGEgZGljdGlvbmFyeS4gYCArXG4gICAgICAgICAgICAgICAgICAgICAgYCR7SlNPTi5zdHJpbmdpZnkoZW52KX0gaXMgZ2l2ZW4gaW5zdGVhZGApO1xuICAgIH1cblxuICAgIGxldCBzaG91bGRXYWl0Rm9yUXVpZXNjZW5jZSA9IHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLndhaXRGb3JRdWllc2NlbmNlKSA/IHRoaXMub3B0cy53YWl0Rm9yUXVpZXNjZW5jZSA6IHRydWU7XG4gICAgbGV0IG1heFR5cGluZ0ZyZXF1ZW5jeSA9IHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLm1heFR5cGluZ0ZyZXF1ZW5jeSkgPyB0aGlzLm9wdHMubWF4VHlwaW5nRnJlcXVlbmN5IDogNjA7XG4gICAgbGV0IHNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyID0gdXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuc2hvdWxkVXNlU2luZ2xldG9uVGVzdE1hbmFnZXIpID8gdGhpcy5vcHRzLnNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyIDogdHJ1ZTtcbiAgICBsZXQgc2hvdWxkVXNlVGVzdE1hbmFnZXJGb3JWaXNpYmlsaXR5RGV0ZWN0aW9uID0gZmFsc2U7XG4gICAgbGV0IGV2ZW50bG9vcElkbGVEZWxheVNlYyA9IHRoaXMub3B0cy53ZGFFdmVudGxvb3BJZGxlRGVsYXkgfHwgMDtcbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuc2ltcGxlSXNWaXNpYmxlQ2hlY2spKSB7XG4gICAgICBzaG91bGRVc2VUZXN0TWFuYWdlckZvclZpc2liaWxpdHlEZXRlY3Rpb24gPSB0aGlzLm9wdHMuc2ltcGxlSXNWaXNpYmxlQ2hlY2s7XG4gICAgfVxuICAgIGlmICh1dGlsLmNvbXBhcmVWZXJzaW9ucyh0aGlzLm9wdHMucGxhdGZvcm1WZXJzaW9uLCAnPT0nLCAnOS4zJykpIHtcbiAgICAgIGxvZy5pbmZvKGBGb3JjaW5nIHNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyIGNhcGFiaWxpdHkgdmFsdWUgdG8gdHJ1ZSwgYmVjYXVzZSBvZiBrbm93biBYQ1Rlc3QgaXNzdWVzIHVuZGVyIDkuMyBwbGF0Zm9ybSB2ZXJzaW9uYCk7XG4gICAgICBzaG91bGRVc2VUZXN0TWFuYWdlckZvclZpc2liaWxpdHlEZXRlY3Rpb24gPSB0cnVlO1xuICAgIH1cbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMubGFuZ3VhZ2UpKSB7XG4gICAgICBhcmdzLnB1c2goJy1BcHBsZUxhbmd1YWdlcycsIGAoJHt0aGlzLm9wdHMubGFuZ3VhZ2V9KWApO1xuICAgICAgYXJncy5wdXNoKCctTlNMYW5ndWFnZXMnLCBgKCR7dGhpcy5vcHRzLmxhbmd1YWdlfSlgKTtcbiAgICB9XG5cbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMubG9jYWxlKSkge1xuICAgICAgYXJncy5wdXNoKCctQXBwbGVMb2NhbGUnLCB0aGlzLm9wdHMubG9jYWxlKTtcbiAgICB9XG5cbiAgICBsZXQgZGVzaXJlZCA9IHtcbiAgICAgIGRlc2lyZWRDYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgYnVuZGxlSWQsXG4gICAgICAgIGFyZ3VtZW50czogYXJncyxcbiAgICAgICAgZW52aXJvbm1lbnQ6IGVudixcbiAgICAgICAgZXZlbnRsb29wSWRsZURlbGF5U2VjLFxuICAgICAgICBzaG91bGRXYWl0Rm9yUXVpZXNjZW5jZSxcbiAgICAgICAgc2hvdWxkVXNlVGVzdE1hbmFnZXJGb3JWaXNpYmlsaXR5RGV0ZWN0aW9uLFxuICAgICAgICBtYXhUeXBpbmdGcmVxdWVuY3ksXG4gICAgICAgIHNob3VsZFVzZVNpbmdsZXRvblRlc3RNYW5hZ2VyLFxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLnNob3VsZFVzZUNvbXBhY3RSZXNwb25zZXMpKSB7XG4gICAgICBkZXNpcmVkLmRlc2lyZWRDYXBhYmlsaXRpZXMuc2hvdWxkVXNlQ29tcGFjdFJlc3BvbnNlcyA9IHRoaXMub3B0cy5zaG91bGRVc2VDb21wYWN0UmVzcG9uc2VzO1xuICAgIH1cbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuZWxlbWVudFJlc3BvbnNlRmllbGRzKSkge1xuICAgICAgZGVzaXJlZC5kZXNpcmVkQ2FwYWJpbGl0aWVzLmVsZW1lbnRSZXNwb25zZUZpZWxkcyA9IHRoaXMub3B0cy5lbGVtZW50UmVzcG9uc2VGaWVsZHM7XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdHMuYXV0b0FjY2VwdEFsZXJ0cykge1xuICAgICAgZGVzaXJlZC5kZXNpcmVkQ2FwYWJpbGl0aWVzLmRlZmF1bHRBbGVydEFjdGlvbiA9ICdhY2NlcHQnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5vcHRzLmF1dG9EaXNtaXNzQWxlcnRzKSB7XG4gICAgICBkZXNpcmVkLmRlc2lyZWRDYXBhYmlsaXRpZXMuZGVmYXVsdEFsZXJ0QWN0aW9uID0gJ2Rpc21pc3MnO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvc2Vzc2lvbicsICdQT1NUJywgZGVzaXJlZCk7XG4gIH1cblxuICAvLyBPdmVycmlkZSBQcm94eSBtZXRob2RzIGZyb20gQmFzZURyaXZlclxuICBwcm94eUFjdGl2ZSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuandwUHJveHlBY3RpdmU7XG4gIH1cblxuICBnZXRQcm94eUF2b2lkTGlzdCAoKSB7XG4gICAgaWYgKHRoaXMuaXNXZWJ2aWV3KCkpIHtcbiAgICAgIHJldHVybiBOT19QUk9YWV9XRUJfTElTVDtcbiAgICB9XG4gICAgcmV0dXJuIE5PX1BST1hZX05BVElWRV9MSVNUO1xuICB9XG5cbiAgY2FuUHJveHkgKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgaXNTYWZhcmkgKCkge1xuICAgIHJldHVybiAhIXRoaXMuc2FmYXJpO1xuICB9XG5cbiAgaXNSZWFsRGV2aWNlICgpIHtcbiAgICByZXR1cm4gdGhpcy5vcHRzLnJlYWxEZXZpY2U7XG4gIH1cblxuICBpc1NpbXVsYXRvciAoKSB7XG4gICAgcmV0dXJuICF0aGlzLm9wdHMucmVhbERldmljZTtcbiAgfVxuXG4gIGlzV2VidmlldyAoKSB7XG4gICAgcmV0dXJuIHRoaXMuaXNTYWZhcmkoKSB8fCB0aGlzLmlzV2ViQ29udGV4dCgpO1xuICB9XG5cbiAgdmFsaWRhdGVMb2NhdG9yU3RyYXRlZ3kgKHN0cmF0ZWd5KSB7XG4gICAgc3VwZXIudmFsaWRhdGVMb2NhdG9yU3RyYXRlZ3koc3RyYXRlZ3ksIHRoaXMuaXNXZWJDb250ZXh0KCkpO1xuICB9XG5cbiAgdmFsaWRhdGVEZXNpcmVkQ2FwcyAoY2Fwcykge1xuICAgIGlmICghc3VwZXIudmFsaWRhdGVEZXNpcmVkQ2FwcyhjYXBzKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSBjYXBhYmlsaXRpZXMgaGF2ZSBvbmUgb2YgYGFwcGAgb3IgYGJ1bmRsZUlkYFxuICAgIGlmICgoY2Fwcy5icm93c2VyTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKSAhPT0gJ3NhZmFyaScgJiYgIWNhcHMuYXBwICYmICFjYXBzLmJ1bmRsZUlkKSB7XG4gICAgICBsZXQgbXNnID0gJ1RoZSBkZXNpcmVkIGNhcGFiaWxpdGllcyBtdXN0IGluY2x1ZGUgZWl0aGVyIGFuIGFwcCBvciBhIGJ1bmRsZUlkIGZvciBpT1MnO1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3cobXNnKTtcbiAgICB9XG5cbiAgICBpZiAoIXV0aWwuY29lcmNlVmVyc2lvbihjYXBzLnBsYXRmb3JtVmVyc2lvbiwgZmFsc2UpKSB7XG4gICAgICBsb2cud2FybihgJ3BsYXRmb3JtVmVyc2lvbicgY2FwYWJpbGl0eSAoJyR7Y2Fwcy5wbGF0Zm9ybVZlcnNpb259JykgaXMgbm90IGEgdmFsaWQgdmVyc2lvbiBudW1iZXIuIGAgK1xuICAgICAgICBgQ29uc2lkZXIgZml4aW5nIGl0IG9yIGJlIHJlYWR5IHRvIGV4cGVyaWVuY2UgYW4gaW5jb25zaXN0ZW50IGRyaXZlciBiZWhhdmlvci5gKTtcbiAgICB9XG5cbiAgICBsZXQgdmVyaWZ5UHJvY2Vzc0FyZ3VtZW50ID0gKHByb2Nlc3NBcmd1bWVudHMpID0+IHtcbiAgICAgIGNvbnN0IHthcmdzLCBlbnZ9ID0gcHJvY2Vzc0FyZ3VtZW50cztcbiAgICAgIGlmICghXy5pc05pbChhcmdzKSAmJiAhXy5pc0FycmF5KGFyZ3MpKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KCdwcm9jZXNzQXJndW1lbnRzLmFyZ3MgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzJyk7XG4gICAgICB9XG4gICAgICBpZiAoIV8uaXNOaWwoZW52KSAmJiAhXy5pc1BsYWluT2JqZWN0KGVudikpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coJ3Byb2Nlc3NBcmd1bWVudHMuZW52IG11c3QgYmUgYW4gb2JqZWN0IDxrZXksdmFsdWU+IHBhaXIge2E6YiwgYzpkfScpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBgcHJvY2Vzc0FyZ3VtZW50c2Agc2hvdWxkIGJlIEpTT04gc3RyaW5nIG9yIGFuIG9iamVjdCB3aXRoIGFyZ3VtZW50cyBhbmQvIGVudmlyb25tZW50IGRldGFpbHNcbiAgICBpZiAoY2Fwcy5wcm9jZXNzQXJndW1lbnRzKSB7XG4gICAgICBpZiAoXy5pc1N0cmluZyhjYXBzLnByb2Nlc3NBcmd1bWVudHMpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gdHJ5IHRvIHBhcnNlIHRoZSBzdHJpbmcgYXMgSlNPTlxuICAgICAgICAgIGNhcHMucHJvY2Vzc0FyZ3VtZW50cyA9IEpTT04ucGFyc2UoY2Fwcy5wcm9jZXNzQXJndW1lbnRzKTtcbiAgICAgICAgICB2ZXJpZnlQcm9jZXNzQXJndW1lbnQoY2Fwcy5wcm9jZXNzQXJndW1lbnRzKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYHByb2Nlc3NBcmd1bWVudHMgbXVzdCBiZSBhIGpzb24gZm9ybWF0IG9yIGFuIG9iamVjdCB3aXRoIGZvcm1hdCB7YXJncyA6IFtdLCBlbnYgOiB7YTpiLCBjOmR9fS4gYCArXG4gICAgICAgICAgICBgQm90aCBlbnZpcm9ubWVudCBhbmQgYXJndW1lbnQgY2FuIGJlIG51bGwuIEVycm9yOiAke2Vycn1gKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChfLmlzUGxhaW5PYmplY3QoY2Fwcy5wcm9jZXNzQXJndW1lbnRzKSkge1xuICAgICAgICB2ZXJpZnlQcm9jZXNzQXJndW1lbnQoY2Fwcy5wcm9jZXNzQXJndW1lbnRzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGAncHJvY2Vzc0FyZ3VtZW50cyBtdXN0IGJlIGFuIG9iamVjdCwgb3IgYSBzdHJpbmcgSlNPTiBvYmplY3Qgd2l0aCBmb3JtYXQge2FyZ3MgOiBbXSwgZW52IDoge2E6YiwgYzpkfX0uIGAgK1xuICAgICAgICAgIGBCb3RoIGVudmlyb25tZW50IGFuZCBhcmd1bWVudCBjYW4gYmUgbnVsbC5gKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyB0aGVyZSBpcyBubyBwb2ludCBpbiBoYXZpbmcgYGtleWNoYWluUGF0aGAgd2l0aG91dCBga2V5Y2hhaW5QYXNzd29yZGBcbiAgICBpZiAoKGNhcHMua2V5Y2hhaW5QYXRoICYmICFjYXBzLmtleWNoYWluUGFzc3dvcmQpIHx8ICghY2Fwcy5rZXljaGFpblBhdGggJiYgY2Fwcy5rZXljaGFpblBhc3N3b3JkKSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYElmICdrZXljaGFpblBhdGgnIGlzIHNldCwgJ2tleWNoYWluUGFzc3dvcmQnIG11c3QgYWxzbyBiZSBzZXQgKGFuZCB2aWNlIHZlcnNhKS5gKTtcbiAgICB9XG5cbiAgICAvLyBgcmVzZXRPblNlc3Npb25TdGFydE9ubHlgIHNob3VsZCBiZSBzZXQgdG8gdHJ1ZSBieSBkZWZhdWx0XG4gICAgdGhpcy5vcHRzLnJlc2V0T25TZXNzaW9uU3RhcnRPbmx5ID0gIXV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLnJlc2V0T25TZXNzaW9uU3RhcnRPbmx5KSB8fCB0aGlzLm9wdHMucmVzZXRPblNlc3Npb25TdGFydE9ubHk7XG4gICAgdGhpcy5vcHRzLnVzZU5ld1dEQSA9IHV0aWwuaGFzVmFsdWUodGhpcy5vcHRzLnVzZU5ld1dEQSkgPyB0aGlzLm9wdHMudXNlTmV3V0RBIDogZmFsc2U7XG5cbiAgICBpZiAoY2Fwcy5jb21tYW5kVGltZW91dHMpIHtcbiAgICAgIGNhcHMuY29tbWFuZFRpbWVvdXRzID0gbm9ybWFsaXplQ29tbWFuZFRpbWVvdXRzKGNhcHMuY29tbWFuZFRpbWVvdXRzKTtcbiAgICB9XG5cbiAgICBpZiAoXy5pc1N0cmluZyhjYXBzLndlYkRyaXZlckFnZW50VXJsKSkge1xuICAgICAgY29uc3Qge3Byb3RvY29sLCBob3N0fSA9IHVybC5wYXJzZShjYXBzLndlYkRyaXZlckFnZW50VXJsKTtcbiAgICAgIGlmIChfLmlzRW1wdHkocHJvdG9jb2wpIHx8IF8uaXNFbXB0eShob3N0KSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgJ3dlYkRyaXZlckFnZW50VXJsJyBjYXBhYmlsaXR5IGlzIGV4cGVjdGVkIHRvIGNvbnRhaW4gYSB2YWxpZCBXZWJEcml2ZXJBZ2VudCBzZXJ2ZXIgVVJMLiBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYCcke2NhcHMud2ViRHJpdmVyQWdlbnRVcmx9JyBpcyBnaXZlbiBpbnN0ZWFkYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNhcHMuYnJvd3Nlck5hbWUpIHtcbiAgICAgIGlmIChjYXBzLmJ1bmRsZUlkKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGAnYnJvd3Nlck5hbWUnIGNhbm5vdCBiZSBzZXQgdG9nZXRoZXIgd2l0aCAnYnVuZGxlSWQnIGNhcGFiaWxpdHlgKTtcbiAgICAgIH1cbiAgICAgIC8vIHdhcm4gaWYgdGhlIGNhcGFiaWxpdGllcyBoYXZlIGJvdGggYGFwcGAgYW5kIGBicm93c2VyLCBhbHRob3VnaCB0aGlzXG4gICAgICAvLyBpcyBjb21tb24gd2l0aCBzZWxlbml1bSBncmlkXG4gICAgICBpZiAoY2Fwcy5hcHApIHtcbiAgICAgICAgbG9nLndhcm4oYFRoZSBjYXBhYmlsaXRpZXMgc2hvdWxkIGdlbmVyYWxseSBub3QgaW5jbHVkZSBib3RoIGFuICdhcHAnIGFuZCBhICdicm93c2VyTmFtZSdgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY2Fwcy5wZXJtaXNzaW9ucykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZm9yIChjb25zdCBbYnVuZGxlSWQsIHBlcm1zXSBvZiBfLnRvUGFpcnMoSlNPTi5wYXJzZShjYXBzLnBlcm1pc3Npb25zKSkpIHtcbiAgICAgICAgICBpZiAoIV8uaXNTdHJpbmcoYnVuZGxlSWQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke0pTT04uc3RyaW5naWZ5KGJ1bmRsZUlkKX0nIG11c3QgYmUgYSBzdHJpbmdgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFfLmlzUGxhaW5PYmplY3QocGVybXMpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke0pTT04uc3RyaW5naWZ5KHBlcm1zKX0nIG11c3QgYmUgYSBKU09OIG9iamVjdGApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgJyR7Y2Fwcy5wZXJtaXNzaW9uc30nIGlzIGV4cGVjdGVkIHRvIGJlIGEgdmFsaWQgb2JqZWN0IHdpdGggZm9ybWF0IGAgK1xuICAgICAgICAgIGB7XCI8YnVuZGxlSWQxPlwiOiB7XCI8c2VydmljZU5hbWUxPlwiOiBcIjxzZXJ2aWNlU3RhdHVzMT5cIiwgLi4ufSwgLi4ufS4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjYXBzLnBsYXRmb3JtVmVyc2lvbiAmJiAhdXRpbC5jb2VyY2VWZXJzaW9uKGNhcHMucGxhdGZvcm1WZXJzaW9uLCBmYWxzZSkpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGAncGxhdGZvcm1WZXJzaW9uJyBtdXN0IGJlIGEgdmFsaWQgdmVyc2lvbiBudW1iZXIuIGAgK1xuICAgICAgICBgJyR7Y2Fwcy5wbGF0Zm9ybVZlcnNpb259JyBpcyBnaXZlbiBpbnN0ZWFkLmApO1xuICAgIH1cblxuICAgIC8vIGZpbmFsbHksIHJldHVybiB0cnVlIHNpbmNlIHRoZSBzdXBlcmNsYXNzIGNoZWNrIHBhc3NlZCwgYXMgZGlkIHRoaXNcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGFzeW5jIGluc3RhbGxBVVQgKCkge1xuICAgIGlmICh0aGlzLmlzU2FmYXJpKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gaWYgdXNlciBoYXMgcGFzc2VkIGluIGRlc2lyZWRDYXBzLmF1dG9MYXVuY2ggPSBmYWxzZVxuICAgIC8vIG1lYW5pbmcgdGhleSB3aWxsIG1hbmFnZSBhcHAgaW5zdGFsbCAvIGxhdW5jaGluZ1xuICAgIGlmICh0aGlzLm9wdHMuYXV0b0xhdW5jaCA9PT0gZmFsc2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgdmVyaWZ5QXBwbGljYXRpb25QbGF0Zm9ybSh0aGlzLm9wdHMuYXBwLCB0aGlzLmlzU2ltdWxhdG9yKCksIGlzVHZPUyh0aGlzLm9wdHMucGxhdGZvcm1OYW1lKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBUT0RPOiBMZXQgaXQgdGhyb3cgYWZ0ZXIgd2UgY29uZmlybSB0aGUgYXJjaGl0ZWN0dXJlIHZlcmlmaWNhdGlvbiBhbGdvcml0aG0gaXMgc3RhYmxlXG4gICAgICBsb2cud2FybihgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqYCk7XG4gICAgICBsb2cud2FybihgJHt0aGlzLmlzU2ltdWxhdG9yKCkgPyAnU2ltdWxhdG9yJyA6ICdSZWFsIGRldmljZSd9IGFyY2hpdGVjdHVyZSBhcHBlYXJzIHRvIGJlIHVuc3VwcG9ydGVkIGAgK1xuICAgICAgICAgICAgICAgYGJ5IHRoZSAnJHt0aGlzLm9wdHMuYXBwfScgYXBwbGljYXRpb24uIGAgK1xuICAgICAgICAgICAgICAgYE1ha2Ugc3VyZSB0aGUgY29ycmVjdCBkZXBsb3ltZW50IHRhcmdldCBoYXMgYmVlbiBzZWxlY3RlZCBmb3IgaXRzIGNvbXBpbGF0aW9uIGluIFhjb2RlLmApO1xuICAgICAgbG9nLndhcm4oJ0RvblxcJ3QgYmUgc3VycHJpc2VkIGlmIHRoZSBhcHBsaWNhdGlvbiBmYWlscyB0byBsYXVuY2guJyk7XG4gICAgICBsb2cud2FybihgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqYCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGF3YWl0IGluc3RhbGxUb1JlYWxEZXZpY2UodGhpcy5vcHRzLmRldmljZSwgdGhpcy5vcHRzLmFwcCwgdGhpcy5vcHRzLmJ1bmRsZUlkLCB0aGlzLm9wdHMubm9SZXNldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IGluc3RhbGxUb1NpbXVsYXRvcih0aGlzLm9wdHMuZGV2aWNlLCB0aGlzLm9wdHMuYXBwLCB0aGlzLm9wdHMuYnVuZGxlSWQsIHRoaXMub3B0cy5ub1Jlc2V0KTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0cy5vdGhlckFwcHMpIHtcbiAgICAgIGF3YWl0IHRoaXMuaW5zdGFsbE90aGVyQXBwcyh0aGlzLm9wdHMub3RoZXJBcHBzKTtcbiAgICB9XG5cbiAgICBpZiAodXRpbC5oYXNWYWx1ZSh0aGlzLm9wdHMuaW9zSW5zdGFsbFBhdXNlKSkge1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzY4ODlcbiAgICAgIGxldCBwYXVzZSA9IHBhcnNlSW50KHRoaXMub3B0cy5pb3NJbnN0YWxsUGF1c2UsIDEwKTtcbiAgICAgIGxvZy5kZWJ1ZyhgaW9zSW5zdGFsbFBhdXNlIHNldC4gUGF1c2luZyAke3BhdXNlfSBtcyBiZWZvcmUgY29udGludWluZ2ApO1xuICAgICAgYXdhaXQgQi5kZWxheShwYXVzZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaW5zdGFsbE90aGVyQXBwcyAob3RoZXJBcHBzKSB7XG4gICAgaWYgKHRoaXMuaXNSZWFsRGV2aWNlKCkpIHtcbiAgICAgIGxvZy53YXJuKCdDYXBhYmlsaXR5IG90aGVyQXBwcyBpcyBvbmx5IHN1cHBvcnRlZCBmb3IgU2ltdWxhdG9ycycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgb3RoZXJBcHBzID0gdGhpcy5oZWxwZXJzLnBhcnNlQ2Fwc0FycmF5KG90aGVyQXBwcyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coYENvdWxkIG5vdCBwYXJzZSBcIm90aGVyQXBwc1wiIGNhcGFiaWxpdHk6ICR7ZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IG90aGVyQXBwIG9mIG90aGVyQXBwcykge1xuICAgICAgYXdhaXQgaW5zdGFsbFRvU2ltdWxhdG9yKHRoaXMub3B0cy5kZXZpY2UsIG90aGVyQXBwLCB1bmRlZmluZWQsIHRoaXMub3B0cy5ub1Jlc2V0KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzZXRJbml0aWFsT3JpZW50YXRpb24gKG9yaWVudGF0aW9uKSB7XG4gICAgaWYgKCFfLmlzU3RyaW5nKG9yaWVudGF0aW9uKSkge1xuICAgICAgbG9nLmluZm8oJ1NraXBwaW5nIHNldHRpbmcgb2YgdGhlIGluaXRpYWwgZGlzcGxheSBvcmllbnRhdGlvbi4gJyArXG4gICAgICAgICdTZXQgdGhlIFwib3JpZW50YXRpb25cIiBjYXBhYmlsaXR5IHRvIGVpdGhlciBcIkxBTkRTQ0FQRVwiIG9yIFwiUE9SVFJBSVRcIiwgaWYgdGhpcyBpcyBhbiB1bmRlc2lyZWQgYmVoYXZpb3IuJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIG9yaWVudGF0aW9uID0gb3JpZW50YXRpb24udG9VcHBlckNhc2UoKTtcbiAgICBpZiAoIV8uaW5jbHVkZXMoWydMQU5EU0NBUEUnLCAnUE9SVFJBSVQnXSwgb3JpZW50YXRpb24pKSB7XG4gICAgICBsb2cuZGVidWcoYFVuYWJsZSB0byBzZXQgaW5pdGlhbCBvcmllbnRhdGlvbiB0byAnJHtvcmllbnRhdGlvbn0nYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgU2V0dGluZyBpbml0aWFsIG9yaWVudGF0aW9uIHRvICcke29yaWVudGF0aW9ufSdgKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy9vcmllbnRhdGlvbicsICdQT1NUJywge29yaWVudGF0aW9ufSk7XG4gICAgICB0aGlzLm9wdHMuY3VyT3JpZW50YXRpb24gPSBvcmllbnRhdGlvbjtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZy53YXJuKGBTZXR0aW5nIGluaXRpYWwgb3JpZW50YXRpb24gZmFpbGVkIHdpdGg6ICR7ZXJyLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG5cbiAgX2dldENvbW1hbmRUaW1lb3V0IChjbWROYW1lKSB7XG4gICAgaWYgKHRoaXMub3B0cy5jb21tYW5kVGltZW91dHMpIHtcbiAgICAgIGlmIChjbWROYW1lICYmIF8uaGFzKHRoaXMub3B0cy5jb21tYW5kVGltZW91dHMsIGNtZE5hbWUpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdHMuY29tbWFuZFRpbWVvdXRzW2NtZE5hbWVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMub3B0cy5jb21tYW5kVGltZW91dHNbREVGQVVMVF9USU1FT1VUX0tFWV07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzZXNzaW9uIGNhcGFiaWxpdGllcyBtZXJnZWQgd2l0aCB3aGF0IFdEQSByZXBvcnRzXG4gICAqIFRoaXMgaXMgYSBsaWJyYXJ5IGNvbW1hbmQgYnV0IG5lZWRzIHRvIGNhbGwgJ3N1cGVyJyBzbyBjYW4ndCBiZSBvblxuICAgKiBhIGhlbHBlciBvYmplY3RcbiAgICovXG4gIGFzeW5jIGdldFNlc3Npb24gKCkge1xuICAgIC8vIGNhbGwgc3VwZXIgdG8gZ2V0IGV2ZW50IHRpbWluZ3MsIGV0Yy4uLlxuICAgIGNvbnN0IGRyaXZlclNlc3Npb24gPSBhd2FpdCBzdXBlci5nZXRTZXNzaW9uKCk7XG4gICAgaWYgKCF0aGlzLndkYUNhcHMpIHtcbiAgICAgIHRoaXMud2RhQ2FwcyA9IGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvJywgJ0dFVCcpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMuZGV2aWNlQ2Fwcykge1xuICAgICAgY29uc3Qge3N0YXR1c0JhclNpemUsIHNjYWxlfSA9IGF3YWl0IHRoaXMuZ2V0U2NyZWVuSW5mbygpO1xuICAgICAgdGhpcy5kZXZpY2VDYXBzID0ge1xuICAgICAgICBwaXhlbFJhdGlvOiBzY2FsZSxcbiAgICAgICAgc3RhdEJhckhlaWdodDogc3RhdHVzQmFyU2l6ZS5oZWlnaHQsXG4gICAgICAgIHZpZXdwb3J0UmVjdDogYXdhaXQgdGhpcy5nZXRWaWV3cG9ydFJlY3QoKSxcbiAgICAgIH07XG4gICAgfVxuICAgIGxvZy5pbmZvKCdNZXJnaW5nIFdEQSBjYXBzIG92ZXIgQXBwaXVtIGNhcHMgZm9yIHNlc3Npb24gZGV0YWlsIHJlc3BvbnNlJyk7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe3VkaWQ6IHRoaXMub3B0cy51ZGlkfSwgZHJpdmVyU2Vzc2lvbixcbiAgICAgIHRoaXMud2RhQ2Fwcy5jYXBhYmlsaXRpZXMsIHRoaXMuZGV2aWNlQ2Fwcyk7XG4gIH1cblxuICBhc3luYyBzdGFydElXRFAgKCkge1xuICAgIHRoaXMubG9nRXZlbnQoJ2l3ZHBTdGFydGluZycpO1xuICAgIHRoaXMuaXdkcFNlcnZlciA9IG5ldyBJV0RQKHtcbiAgICAgIHdlYmtpdERlYnVnUHJveHlQb3J0OiB0aGlzLm9wdHMud2Via2l0RGVidWdQcm94eVBvcnQsXG4gICAgICB1ZGlkOiB0aGlzLm9wdHMudWRpZCxcbiAgICAgIGxvZ1N0ZG91dDogISF0aGlzLm9wdHMuc2hvd0lXRFBMb2csXG4gICAgfSk7XG4gICAgYXdhaXQgdGhpcy5pd2RwU2VydmVyLnN0YXJ0KCk7XG4gICAgdGhpcy5sb2dFdmVudCgnaXdkcFN0YXJ0ZWQnKTtcbiAgfVxuXG4gIGFzeW5jIHN0b3BJV0RQICgpIHtcbiAgICBpZiAodGhpcy5pd2RwU2VydmVyKSB7XG4gICAgICBhd2FpdCB0aGlzLml3ZHBTZXJ2ZXIuc3RvcCgpO1xuICAgICAgZGVsZXRlIHRoaXMuaXdkcFNlcnZlcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyByZXNldCAoKSB7XG4gICAgaWYgKHRoaXMub3B0cy5ub1Jlc2V0KSB7XG4gICAgICAvLyBUaGlzIGlzIHRvIG1ha2Ugc3VyZSByZXNldCBoYXBwZW5zIGV2ZW4gaWYgbm9SZXNldCBpcyBzZXQgdG8gdHJ1ZVxuICAgICAgbGV0IG9wdHMgPSBfLmNsb25lRGVlcCh0aGlzLm9wdHMpO1xuICAgICAgb3B0cy5ub1Jlc2V0ID0gZmFsc2U7XG4gICAgICBvcHRzLmZ1bGxSZXNldCA9IGZhbHNlO1xuICAgICAgY29uc3Qgc2h1dGRvd25IYW5kbGVyID0gdGhpcy5yZXNldE9uVW5leHBlY3RlZFNodXRkb3duO1xuICAgICAgdGhpcy5yZXNldE9uVW5leHBlY3RlZFNodXRkb3duID0gKCkgPT4ge307XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLnJ1blJlc2V0KG9wdHMpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdGhpcy5yZXNldE9uVW5leHBlY3RlZFNodXRkb3duID0gc2h1dGRvd25IYW5kbGVyO1xuICAgICAgfVxuICAgIH1cbiAgICBhd2FpdCBzdXBlci5yZXNldCgpO1xuICB9XG59XG5cbk9iamVjdC5hc3NpZ24oWENVSVRlc3REcml2ZXIucHJvdG90eXBlLCBjb21tYW5kcyk7XG5cbmV4cG9ydCBkZWZhdWx0IFhDVUlUZXN0RHJpdmVyO1xuZXhwb3J0IHsgWENVSVRlc3REcml2ZXIgfTtcbiJdLCJmaWxlIjoibGliL2RyaXZlci5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiJ9
